<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>F-LOAM论文阅读</title>
      <link href="/2022/11/10/20221110/"/>
      <url>/2022/11/10/20221110/</url>
      
        <content type="html"><![CDATA[<h1>论文总结</h1><p><strong>主要工作</strong>：提出了一个计算高效的激光 SLAM 框架，旨在为计算资源有限的机器人应用程序提供公共解决办法</p><p><strong>算法特点</strong>：计算成本和定位精度的较好平衡</p><p><strong>核心思想</strong>：</p><ol><li>使用非迭代的两步失真补偿方法替换计算成本较高的迭代失真补偿方法</li><li>将局部几何特征应用于迭代位姿估计，具体表现就是权重函数</li></ol><p><strong>创新点</strong>：</p><ol><li>非迭代的两步失真补偿方法</li><li>将局部几何特征应用于迭代位姿估计</li></ol><p><strong>算法结果</strong>：</p><ol><li>算法在室内环境测试实现 2cm 的平均定位精度</li><li>是 KITTI 数据集中最准确和最快的开源算法之一</li></ol><p>个人理解：取消了里程计算法，降低计算成本，只使用匀速假设模型简单处理，直接使用Mapping</p><h1>Abstract</h1><ol><li><p>对于一个好的SLAM系统，计算效率和定位精度都很重要</p></li><li><p>现有的基于雷达的SLAM通常把问题分为两部分</p><p>scan-to-scan 的匹配</p><p>scan-to-map 的优化</p></li><li><p>两个模块都通过迭代计算求解，计算代价很高</p></li><li><p>本文提出一个通用的解决办法，旨在为基于雷达的SLAM提供一个高效精确的框架</p></li><li><p>具体的说，提出了一个非迭代的两阶段失真补偿方法降低计算量</p></li><li><p>每一帧，提取边缘和平面特征，分别与局部边缘地图和局部平面地图匹配，同时考虑迭代位姿优化时的光滑度</p></li><li><p>在一些场景中实验评估性能，包括AGV的定位和公共数据集</p></li><li><p>结果表明，在公共数据集的评估中，该方法在处理速度大于10Hz的情况下，定位精度方面有竞争力，平衡了实际应用中的性能和计算代价</p></li><li><p>是KITTI排名中最准确和最快的开源SLAM系统之一</p></li></ol><h1>I. INTRODUCTION</h1><ol><li><p>SLAM 简介</p><p>SLAM 是什么；SLAM 分类，激光，视觉；激光SLAM 的优势</p></li><li><p>现有工作</p><p>公共数据集表现较好，但实际应用中存在限制：</p><p>限制一：对不同环境的鲁棒性 (室内室外；静态动态)</p><p>限制二：计算成本 (嵌入式系统计算资源不足)</p><p>此外，很多算法不开源，因为很难得到相同的结果</p></li><li><p>常用方法</p><p>第一种，ICP，最经典，最小化点云距离对齐两帧，但点太多，效率很低</p><p>第二种，以LOAM为代表的特征点匹配，但迭代计算的计算成本仍然较高</p></li><li><p>本文提出的算法</p><p>本文提出一种轻量的激光SLAM，旨在提供实时的解决方案；</p><p>一个结合特征提取，失真补偿，位姿优化和建图的框架；</p><p>用非迭代的两步失真补偿方法替代传统的迭代失真补偿方法</p><p>迭代位姿估计考虑局部几何特征以提高定位精度</p><p>一系列实验结果表明本文算法能以较低成本实现具有竞争力的定位精度，即性能和速度的良好平衡</p><p>是KITTI基准测试中最准确和最快的开源方法之一</p></li><li><p>内容安排</p><p>第二节介绍现有SLAM 相关工作</p><p>第三节介绍所提出算法的细节</p><p>第四节介绍实验结果</p><p>第五节说明结论</p></li></ol><h1>II. RELATED WORK</h1><p>当前已有的一些工作</p><ol><li><p>激光SLAM最重要的步骤是点云匹配，当前主要有两种方式</p><p>原始点云匹配</p><p>特征点匹配</p></li><li><p>原始点云匹配</p><p>ICP：最经典，找最近点，最小化对应点间距离残差</p><p>IMLS-SLAM：有改进，由IMLS设权重，但计算成本很高</p></li><li><p>特征点匹配</p><p>基于特征的方法主要利用点到线/面的距离，由LOAM提出，被广泛使用</p><p>LeGO-LOAM在特征提取前进行地面分离，获得了更好的性能</p><p>地面点对x-y平面没有贡献，因此去掉地面点的方式广泛应用于地面车辆</p></li><li><p>引入额外的模块提升性能</p><p>引入回环检测模块，解决长时间SLAM中激光SLAM不可避免的漂移问题</p><p>LOL算法中，将激光SLAM扩展到有回环的完整SLAM</p><p>LIO-SLAM中，提出IMU和GPS融合的方式</p><p>结果证明融合方式能提高定位精度，但多传感器融合需要同步和综合校准</p></li><li><p>与深度学习结合</p><p>使用卷积神经网络进行点云处理，通过CNN训练提取特征点</p><p>CAE-LO中，通过CAE提出基于深度学习的特征点选择规则，里程计仍基于特征点匹配</p><p>试验结果表明深度学习能提高匹配成功率，但不同环境中不具备鲁棒性</p></li></ol><h1>III. METHODOLOGY</h1><h2 id="A-Sensor-Model-and-Feature-Extraction">A. Sensor Model and Feature Extraction</h2><ol><li>激光雷达行数为 M，扫描 k 表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，其中每个点表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="bold">p</mi><mi>k</mi><mrow><mo fence="true">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo fence="true">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbf{p}_{k}^{\left( m,n \right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathbf">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span> ，m和n为行列</li><li>使用特征匹配，丢弃噪声和不重要的点</li><li>计算每个点的平滑度 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>k</mi><mrow><mo fence="true">(</mo><mi>m</mi><mo separator="true">,</mo><mi>n</mi><mo fence="true">)</mo></mrow></msubsup></mrow><annotation encoding="application/x-tex">\sigma _{k}^{\left( m,n \right)}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3461em;vertical-align:-0.3013em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">σ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.0448em;"><span style="top:-2.3987em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.2198em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight">m</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">n</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3013em;"><span></span></span></span></span></span></span></span></span></span>，与LOAM相同，取前后五个点</li><li>选取方式也与LOAM相同，平滑度高的为边缘点，低的为平面点；最终得到边缘点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ε</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\varepsilon _k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">ε</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，平面点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>S</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">S_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0576em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ol><h2 id="B-Motion-Estimation-and-Distortion-Compensation">B. Motion Estimation and Distortion Compensation</h2><ol><li><p>现有的LOAM，LeGO-LOAM算法通过scan-to-scan进行失真校正；但迭代计算求解变换矩阵的方式计算效率低</p></li><li><p>本文提出两步失真补偿的方式降低计算成本</p><p>setp1：假定短时间内以恒定角速度和线速度预测运动并校正失真</p><p>step2：位姿估计之后重新计算失真，将校正过的特征点更新到最终地图</p></li><li><p>试验结果表明，两步失真补偿达到相似精度时，计算成本要低得多</p></li><li><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">T_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示扫描 k 时的4×4齐次变换矩阵</p></li></ol><p>【】个人理解：就是通过<strong>匀速模型假设</strong>和<strong>线性插值</strong>进行<strong>运动补偿</strong></p><h2 id="C-Pose-Estimation">C. Pose Estimation</h2><ol><li>位姿估计将校正过的特征点与全局特征地图匹配</li><li>边缘点计算全局边缘特征地图附近点的协方差矩阵，若线性分布，最大特征向量即为线的方向</li><li>平面点同样计算协方差矩阵，得到一个平面</li><li>通过优化特征点到对应特征的方式求解位姿变换关系</li><li>传统特征匹配只优化几何距离，不考虑特征点的局部几何分布，但特征点通常在联系扫描过程中被一致的提取，因此引入权重函数平衡匹配过程</li><li>使用平滑度进行权重定义，通过最小化加权距离估计位姿</li><li>最优位姿估计通过高斯牛顿法求解非线性方程得到，迭代直到收敛</li></ol><h2 id="D-Mapping-Building-Distortion-Compensation-Update">D. Mapping Building &amp; Distortion Compensation Update</h2><ol><li>全局地图由全局边缘地图和全局平面地图组成，根据关键帧进行更新</li><li>关键帧的选择由设定好的旋转或平移阈值决定，超过阈值则选取</li><li>失真补偿是匀速运动假设，因此准确度不如LOAM的迭代失真补偿准确，因此第二阶段，根据优化结果重新计算失真</li><li>重新校正过的边缘和平面特征将全局边缘和平面地图进行更新</li><li>每次更新后，降采样，防止内存溢出</li></ol><h1>IV. EXPERIMENT EVALUATION</h1><h2 id="A-Experiment-Setup">A. Experiment Setup</h2><ol><li>使用大规模室外环境和中等规模室内环境对算法进行评估</li><li>大规模实验使用KITTI数据集</li><li>中等规模实验使用仓储物流环境，分别在环境中和AGV平台上测试</li></ol><h2 id="B-Evaluation-on-Public-Dataset">B. Evaluation on Public Dataset</h2><p>使用 KITTI 中的 00-10 序列进行评估，评价指标采用平均平移误差 ATE 和平均旋转误差 ARE</p><ol><li><p>实验结果：在11个序列上实现了 0.8% 的 ATE 和 0.0048°/m 的 ARE</p><p><img src="/2022/11/10/20221110/KITTI%E6%95%B0%E6%8D%AE%E9%9B%86%E7%BB%93%E6%9E%9C.png" alt="KITTI数据集结果"></p></li><li><p>将本文算法与目前最先进的算法作比较，包括视觉和激光，使用相同处理器的计算机对时间进行评估</p></li><li><p>为保证一致性，不使用IMU和回环检测，基于同一环境进行测试</p></li><li><p><img src="/2022/11/10/20221110/%E5%90%84%E7%AE%97%E6%B3%95%E5%AF%B9%E6%AF%94%E7%BB%93%E6%9E%9C.png" alt="各算法对比结果"></p><p>与个算法比较结果表明：</p><p>IMLS-SLAM 最准确，但速度很慢；</p><p>激光 SLAM 中，LeGO-LOAM 最快，因为它只使用非地面点进行优化；</p><p>本文提出的算法以超过 10Hz 的平均处理速率达到了第二高的精度，实现计算成本和定位精度之间较好的平衡</p></li><li><p>综上所述，本文提出的算法能为实时机器人应用提供快速和准确的 SLAM 解决方案，并且在最先进的方法中具有竞争力</p></li></ol><h2 id="C-Experiment-on-warehouse-logistics">C. Experiment on warehouse logistics</h2><p>本实验的目的是建造一个自动的仓储机器人，AGV旨在执行运输等任务，这要求机器人平台能在复杂环境中主动定位自己</p><p>以下实验证明了F-LOAM在实际应用中的鲁棒性</p><h3 id="Simulation">Simulation</h3><p>首先使用模拟环境验证算法，模拟环境重构了一个复杂的仓库环境，实验证明本文提出的方法能够在人类操作员在仓库环境中行走的动态环境下跟踪高速移动的 AGV</p><p><img src="/2022/11/10/20221110/%E4%BB%93%E5%BA%93%E6%A8%A1%E6%8B%9F%E7%8E%AF%E5%A2%83.png" alt="仓库模拟环境"></p><h3 id="Experiment">Experiment</h3><p>为进一步证明算法性能，在实际的AGV上实现F-LOAM，并在真实仓储环境中测试</p><p><img src="/2022/11/10/20221110/%E4%BB%93%E5%BA%93%E7%9C%9F%E5%AE%9E%E7%8E%AF%E5%A2%83.png" alt="仓库真实环境"></p><h3 id="Performance-evaluation">Performance evaluation</h3><p>在室内环境中使用F-LOAM进行测试，以评估定位精度</p><p><img src="/2022/11/10/20221110/%E5%AE%A4%E5%86%85%E7%8E%AF%E5%A2%83%E6%B5%8B%E8%AF%95%E7%BB%93%E6%9E%9C.png" alt="室内环境测试结果"></p><p>结果表明，F-LOAM能实现与真值相比 2cm 的平均定位精度</p><h3 id="Ablation-study">Ablation study</h3><p>消融实验，评估本文提出的失真补偿方法的性能，分为三部分：</p><ul><li>去掉失真补偿的 F-LOAM</li><li>使用 LOAM 中的迭代失真补偿方法的 F-LOAM</li><li>使用本文提出的失真补偿方法的 F-LOAM</li></ul><p><img src="/2022/11/10/20221110/%E5%A4%B1%E7%9C%9F%E8%A1%A5%E5%81%BF%E6%96%B9%E6%B3%95%E6%B6%88%E8%9E%8D%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C.png" alt="失真补偿方法消融实验结果"></p><p>结果表明本文提出的失真补偿方法比LOAM的迭代补偿方法快的多，同时定位精度也更高</p><h1>V. CONCLUSION</h1><ol><li><p>本文提出了一个计算高效的激光 SLAM 框架，旨在为计算资源有限的机器人应用程序提供公共解决办法</p></li><li><p>与传统方法相比，本文提出非迭代的两步失真补偿方法降低计算成本</p></li><li><p>边缘和平面特征被连续帧一致提取，因此将局部几何特征应用于迭代姿态估计，具体表现就是加权重</p></li><li><p>为了证明本文提出的方法在实际应用中的鲁棒性，进行一系列实验测试</p></li><li><p>结果为：</p><p>算法在室内测试实现 2cm 的平均定位精度</p><p>是 KITTI 数据集中最准确和最快的开源算法之一</p></li></ol>]]></content>
      
      
      <categories>
          
          <category> SLAM论文阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> 论文阅读 </tag>
            
            <tag> F-LOAM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SLAM算法评估工具：EVO</title>
      <link href="/2022/10/28/20221028/"/>
      <url>/2022/10/28/20221028/</url>
      
        <content type="html"><![CDATA[<h1>SLAM 算法评估工具：EVO</h1><p>下载安装后可命令行全局调用；只需在轨迹文件夹下使用命令即可</p><h2 id="基础知识">基础知识</h2><h3 id="数据格式">数据格式</h3><p>可用的文件格式为：<code>tum</code> , <code>kitti</code> , <code>euroc</code> , <code>bag</code> 等，常用前两种格式</p><ol><li><p><code>tum</code> ：每行有 8 个元素，结尾没有空格，时间以秒为单位</p><blockquote><p>[ timestamp   tx   ty   tz   qx   qy   qz   qw]</p></blockquote><p>8 个元素包括时间戳，位置和方向(四元数表示)</p><p><code>tum</code> 可转换成任何格式</p></li><li><p><code>kitti</code> ：每行 12 个元素，<strong>没有时间戳</strong></p><blockquote><p>每一行包含了齐次位姿矩阵( SE(3) matrix )的前三行，如下面所示：</p><p>位姿矩阵：</p><p>​a  b  c  d<br>​e  f   g  h<br>​i   j   k   l<br>​0  0  0  1</p><p>文件中表示：</p><p>​a   b   c   d   e   f   g   h   i   j   k   l</p></blockquote><p><code>kitti</code> 在没有时间戳文件的情况下，不能转换为其他任何格式；</p><p>具体使用时常通过 python 脚本将 <code>kitti</code> 格式文件及对应 <code>时间戳文件</code> 一并转换为 <code>tum</code> 格式，如 evo 工具中的<code>kitti_poses_and_timestamps_to_trajectory.py</code> 脚本</p><p>【注】使用kitti格式要小心，因为想要用这种格式比较两个文件时，要求两文件的位姿数量必须完全相同</p></li></ol><h3 id="主要命令简介">主要命令简介</h3><h4 id="轨迹相关-evo-traj">轨迹相关  evo_traj</h4><p>该命令是evo的主要工具，以下场景中会用到：</p><ul><li>显示信息</li><li>画图</li><li>验证数据有效性</li><li>导出为其它格式</li><li>应用转换</li></ul><p>evo_traj 默认会在命令行输出简略但最重要的信息</p><p><code>-v</code> 参数会显示详细信息，例如起止时间，起止位姿</p><p><code>--full_check</code> 参数，会进行一些数学和逻辑上的检查，如四元数有单位范数，时间戳递增等，同时还会显示速度信息</p><p><code>-p</code> 参数，画出命令中列出的轨迹；<code>--plot_mode</code> 参数，指出画图的模式，常用 <code>xz</code> 或 <code>xyz</code></p><h4 id="轨迹对齐">轨迹对齐</h4><p>对齐需使用 <code>--ref</code> 参数<strong>指定参考轨迹</strong>，之后可使用几何配准方法(基于Umeyama算法)将其它轨迹与指定轨迹对齐</p><table><thead><tr><th>可选参数</th><th>含义</th></tr></thead><tbody><tr><td>-a</td><td>SE(3) Umeyama alignment (旋转，平移)</td></tr><tr><td>-as</td><td>Sim(3) Umeyama alignment (旋转，平移，尺度)</td></tr><tr><td>-s</td><td>scale correction only (尺度)</td></tr><tr><td>–align_origin</td><td>origin alignment (原点对齐，与上面三种不同)</td></tr></tbody></table><p>【注】v1.5.0版本之后可使用 <code>origin alignment</code> 方式对齐，用于漂移和回环的评估，该方式与上面三种不同，不是基于Umeyama算法</p><p>效果如下：</p><p><img src="/2022/10/28/20221028/%E5%AF%B9%E9%BD%90%E6%96%B9%E5%BC%8F%E5%9B%BE%E8%A7%A3.png" alt="对齐方式图解"></p><p>【注】旋转平移指的是其余轨迹经旋转平移后与指定轨迹对齐；尺度指大小的缩放</p><h4 id="评估相关">评估相关</h4><p>对齐方式与轨迹命令中的解释相同，且<strong>对齐方式对得到的结果是有影响的</strong>，如何找到合适的对齐方式？？？</p><ul><li><p>对于ape，不同对齐方式得到的结果均不同</p></li><li><p>对于rpe，不加参数、<code>-a</code>、<code>--align_origin</code>得到的结果相同，-as得到的结果不同</p></li></ul><h5 id="绝对位姿误差-evo-ape">绝对位姿误差  evo_ape</h5><p>直接比较参考轨迹与估计轨迹的对应位姿，之后计算整个轨迹的数据，<strong>用于测试轨迹的全局一致性</strong></p><p><code>-r</code> 参数指定模式，其后跟：</p><table><thead><tr><th>可选参数</th><th>含义</th></tr></thead><tbody><tr><td>full</td><td>表示同时考虑旋转和平移误差得到的 ape，无单位（unit-less）</td></tr><tr><td>trans_part</td><td>考虑平移部分得到的 ape，单位为 m</td></tr><tr><td>rot_part</td><td>考虑旋转部分得到的 ape，无单位（unit-less）</td></tr><tr><td>angle_deg</td><td>考虑旋转角得到的 ape，单位为 °（deg）</td></tr><tr><td>angle_rad</td><td>考虑旋转角得到的 ape，单位为 弧度（rad）</td></tr></tbody></table><p>不添加-r/–pose_relation和可选项，则默认为trans_part</p><h5 id="相对位姿误差-evo-rpe">相对位姿误差  evo_rpe</h5><p>比较<strong>位姿增量</strong>，而不是直接比较对应位姿，这个给出了<strong>局部精度的度量</strong>，即漂移，例如每米的旋转和漂移</p><p><code>-r</code> 参数指定模式，各参数含义[参考 ape](# 绝对位姿误差  evo_ape)</p><p>相对位姿因为相对，所以常用其它比较方式，参数设置如下：</p><table><thead><tr><th>可选参数</th><th>含义</th></tr></thead><tbody><tr><td>-d</td><td>即–delta，表示相对位姿间增量 ，默认为1 (就是增量 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Δ</mi></mrow><annotation encoding="application/x-tex">\varDelta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathit">Δ</span></span></span></span> )</td></tr><tr><td>-u</td><td>即–delta_unit，表示增量的单位，可选参数为 [ f, d, r, m ]</td></tr><tr><td></td><td>[ f, d, r, m ]分别表示 [ frames, deg, rad, meters ]</td></tr></tbody></table><p>其中 deg 为角度， rad 为弧度</p><p>–d 和 -u 合起来表示衡量局部精度的单位，如：(表格中的 rpe 具体指什么取决于命令中给的参数)</p><table><thead><tr><th>可选参数</th><th>含义</th></tr></thead><tbody><tr><td>-d 1 -u m</td><td>每米的 rpe</td></tr><tr><td>-d 1 -u rad</td><td>每弧度的 rpe</td></tr><tr><td>-d 100 -u m</td><td>每百米的 rpe</td></tr></tbody></table><h5 id="比较多个结果-evo-res">比较多个结果  evo_res</h5><p>将不同算法对同一个数据集的结果进行比较，同时画出多种算法比较的效果图</p><h5 id="结果说明">结果说明</h5><blockquote><p>max：最大误差<br>mean：误差均值<br>median：误差中位数<br>min：最小误差<br>rmse：均方根误差<br>sse：方差<br>std：标准差</p></blockquote><h2 id="常用命令">常用命令</h2><p>下列命令无特殊说明均使用 <code>tum</code> 格式数据</p><h3 id="查看轨迹信息">查看轨迹信息</h3><p>使用时将 A , B , C 替换为对应文件名</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evo_traj tum A.txt B.txt C.txt</span><br></pre></td></tr></table></figure><h3 id="画图">画图</h3><p>根据需要列出对应轨迹名称即可(不考虑对齐)</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 画xz轴，2D</span><br><span class="line">evo_traj tum fr2_desk_ORB.txt -p --plot_mode xz</span><br><span class="line"></span><br><span class="line">// 画xyz轴，3D</span><br><span class="line">evo_traj tum fr2_desk_ORB.txt -p --plot_mode xyz</span><br></pre></td></tr></table></figure><p>绘制多个轨迹，同时要求<strong>对齐</strong>，<code>--ref</code> 后跟参考轨迹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evo_traj tum gt.txt A.txt -as --ref gt.txt -p --plot_mode xz</span><br></pre></td></tr></table></figure><h3 id="评估-计算-ape-和-rpe">评估 (计算 ape 和 rpe )</h3><p>计算 ape，比较全局一致性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 不用于后续res比较</span><br><span class="line">evo_ape tum gt.txt A.txt -va</span><br><span class="line"></span><br><span class="line">// 比较多个算法效果,存储路径需要修改</span><br><span class="line">evo_ape tum gt.txt A.txt -va --save_result ~/Result/test1.zip</span><br></pre></td></tr></table></figure><p>【注】论文中<strong>常用的ATE数据</strong>就是 evo_ape 在默认参数下得到的 rmse</p><p>计算 rpe，比较局部精确性</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 不用于后续res比较</span><br><span class="line">evo_rpe tum gt.txt A.txt</span><br><span class="line"></span><br><span class="line">// 存储结果，用于后续比较多个算法效果,存储路径需要修改</span><br><span class="line">evo_rpe tum gt.txt A.txt -va --save_result ~/Result/test1.zip</span><br><span class="line"></span><br><span class="line">// 计算每百米的旋转误差，即[°/100m]，论文中常用(但对齐方式不确定)</span><br><span class="line">evo_rpe tum gt.txt A.txt -a -r angle_deg -d 100 -u m</span><br></pre></td></tr></table></figure><p>多算法结果比较，evo_res</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">evo_res ~/Results/*.zip -p --save_table ~/Results/table.csv</span><br></pre></td></tr></table></figure><h3 id="kitti-格式文件转-tum-格式"><code>kitti</code> 格式文件转 <code>tum</code> 格式</h3><p>需要位姿和对应时间戳文件，二者要求行数相同</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 进入对应python脚本所在文件夹</span><br><span class="line">cd ~/evo/contrib</span><br><span class="line"></span><br><span class="line">// 生成tum格式真值，需修改对应路径</span><br><span class="line">python3 kitti_poses_and_timestamps_to_trajectory.py ~/ground_truth/poses/00.txt ~/ground_truth/timestamps/00_timestamps.txt ~/data/ground_truth/tum_00_gt.txt</span><br></pre></td></tr></table></figure><h2 id="轨迹生成代码">轨迹生成代码</h2><p>介绍需要添加在算法中的生成 <code>tum</code> 格式轨迹文件的代码</p><p>轨迹文件分为优化前和优化后，因为某些算法有回环检测模块，因此优化后的轨迹文件需要在算法全部跑完后生成，而不能实时生成</p><p><strong>暂定</strong>使用以下代码实现实时的tum格式轨迹输出，有回环检测的的后续补上</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 生成tum格式轨迹，加入到代码中合适的地方</span><br><span class="line">double timeStart = odometryBuf.front()-&gt; header.stamp.toSec();  // 获得起始时间</span><br><span class="line">SaveTumTraj(timeStart,odomAftMapped);  // 调用生成函数</span><br><span class="line"></span><br><span class="line">// ---------------------------下面为放在文件开始的函数定义-------------------------------</span><br><span class="line"></span><br><span class="line">// 加入的生成TUM格式轨迹的函数(坐标轴不对，但可通过-a对齐)</span><br><span class="line">void SaveTumTraj(const double &amp; timeStart,const nav_msgs::Odometry &amp; q_t)</span><br><span class="line">&#123;</span><br><span class="line">    // 修改轨迹路径</span><br><span class="line">    std::ofstream pose1(&quot;/home/lmay/Result/test_1.txt&quot;, std::ios::app);</span><br><span class="line">pose1.setf(std::ios::scientific, std::ios::floatfield);</span><br><span class="line">pose1.precision(8);</span><br><span class="line"></span><br><span class="line">auto T1 = ros::Time().fromSec(timeStart);</span><br><span class="line">pose1 &lt;&lt; q_t.header.stamp - T1  &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.position.x &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.position.y &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.position.z &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.orientation.x &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.orientation.y &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.orientation.z &lt;&lt; &quot; &quot;</span><br><span class="line">              &lt;&lt; q_t.pose.pose.orientation.w &lt;&lt; std::endl;</span><br><span class="line">pose1.close();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="完整评估流程">完整评估流程</h2><p>介绍从加入代码生成轨迹文件，到最终获得论文中可用的数据及图像的完整过程</p><p>【注】图片不自动存储，在画出相应图后若需要，则经调整后手动保存</p><p>step1. 在算法相应位置加入[轨迹输出的代码](# 轨迹生成代码)</p><p>step2. 修改生成文件的路径</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 修改前</span><br><span class="line">std::ofstream pose1(&quot;/home/lmay/Result/test_1.txt&quot;, std::ios::app);</span><br><span class="line"></span><br><span class="line">// 修改后</span><br><span class="line">std::ofstream pose1(&quot;/home/lmay/Result/05/1.txt&quot;, std::ios::app);</span><br><span class="line"></span><br><span class="line">// 对比算法修改后</span><br><span class="line">std::ofstream pose1(&quot;/home/lmay/Result/05/2.txt&quot;, std::ios::app);</span><br></pre></td></tr></table></figure><p>step3. 进入相应算法文件夹下重新编译，并运行算法</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd ~/TestSLAM</span><br><span class="line">catkin_make</span><br><span class="line"></span><br><span class="line">// 新终端1</span><br><span class="line">cd</span><br><span class="line">source ~/aloam_ws/devel/setup.bash</span><br><span class="line">roslaunch aloam_velodyne aloam_velodyne_VLP_16.launch</span><br><span class="line"></span><br><span class="line">// 新终端2</span><br><span class="line">cd ~/data/kitti</span><br><span class="line">rosbag play 05.bag</span><br></pre></td></tr></table></figure><p>step4. 同理，修改存储路径，重复前三步，生成对比算法的结果</p><p>step5. 查看两算法大致效果，保存轨迹对比图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd ~/Result/05</span><br><span class="line"></span><br><span class="line">// 比较单个算法结果</span><br><span class="line">evo_traj tum tum_05_gt.txt 1.txt --ref tum_05_gt.txt -a -p --plot_mode xz</span><br><span class="line"></span><br><span class="line">// 比较多个算法结果</span><br><span class="line">evo_traj tum tum_05_gt.txt 1.txt 2.txt --ref tum_05_gt.txt -a -p --plot_mode xz</span><br></pre></td></tr></table></figure><p>step6. 使用 evo_ape 分别将两算法与真值比较，计算 rmse，即论文中的ATE结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// 自己改进过的算法</span><br><span class="line">evo_ape tum tum_05_gt.txt 1.txt -a --save_result ~/Resule/05/ape/1.zip</span><br><span class="line"></span><br><span class="line">// 进行比较的算法</span><br><span class="line">evo_ape tum tum_05_gt.txt 2.txt -a --save_result ~/Resule/05/ape/2.zip</span><br></pre></td></tr></table></figure><p>step7. 使用evo_rpe分别将两算法与真值比较，计算论文中的[°/100m]结果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">// [°/100m]</span><br><span class="line">// 自己改进过的算法</span><br><span class="line">evo_rpe tum tum_05_gt.txt 1.txt -a -r angle_deg -d 100 -u m --save_result ~/Resule/05/rpe/1.zip</span><br><span class="line"></span><br><span class="line">// 进行比较的算法</span><br><span class="line">evo_rpe tum tum_05_gt.txt 2.txt -a -r angle_deg -d 100 -u m --save_result ~/Resule/05/rpe/2.zip</span><br></pre></td></tr></table></figure><p>step8. 使用 evo_res 分别对 ape 和 rpe 得到的结果进行对比，保存需要的图片</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 对比两算法 ape</span><br><span class="line">cd ~/Result/05/ape</span><br><span class="line">evo_res *.zip -p --save_table ~/Result/ape_table.csv</span><br><span class="line"></span><br><span class="line">// 对比两算法 rpe</span><br><span class="line">cd ~/Result/05/rpe</span><br><span class="line">evo_res *.zip -p --save_table ~/Result/rpe_table.csv</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SLAM工具 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> 工具 </tag>
            
            <tag> 算法评估 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LeGO-LOAM论文阅读</title>
      <link href="/2022/10/20/20221020/"/>
      <url>/2022/10/20/20221020/</url>
      
        <content type="html"><![CDATA[<h1>LeGO-LOAM</h1><h2 id="整体总结">整体总结</h2><p><strong>主要工作：</strong> 在LOAM基础上，提出一种耗费计算资源少，可在嵌入式系统中实时处理的SLAM算法</p><p><strong>核心思想：</strong></p><ol><li>通过<strong>地面分离，点云分割</strong>过滤掉不可靠的特征点，减少特征点数量；</li><li>通过降低特征点数量，并使用<strong>两步LM优化</strong>方法，保证算法实时性</li></ol><p><strong>创新点：</strong></p><ol><li>使用 <code>范围图像</code> 对点云进行处理？？？</li><li>地面分离，点云分割</li><li>两步LM优化方法</li></ol><p><strong>算法结果：</strong> 与LOAM算法相比，显著降低计算时间，同时获得与LOAM相似或更高的精确度</p><h2 id="论文精读">论文精读</h2><h3 id="Abstract">Abstract</h3><ol><li>提出了一种轻量的，地面优化的雷达里程计和建图方法，LeGO-LOAM，能够对地面车辆进行实时的六自由度位姿估计</li><li>是轻量的，因为能够在低功耗的嵌入式系统中实现实时的位姿估计</li><li>是地面优化的，因为在分割和优化步骤中利用了地面</li><li>首先使用点云分割过滤噪声，之后特征提取获得边缘点和平面点</li><li>然后，<code>两步LM优化方法</code> 使用特征点解决 <code>连续扫描中六自由度变换的不同分量</code></li><li>使用地面车从可变地形环境中收集到的数据集，将LeGO-LOAM与LOAM作比较，结果表明<code>降低计算成本情况下实现了与LOAM相似或更好的精度</code></li><li>还将LeGO-LOAM集成到SLAM框架中，以消除漂移导致的位姿估计误差，同时使用KITTI数据集进行测试</li></ol><h3 id="I-INTRODUCTION">I. INTRODUCTION</h3><ol><li><p>激光和视觉的优劣分析</p><p>视觉光照，视点变化敏感，只使用视觉传感器不可靠；激光没有这个问题，而且很多激光雷达能获得大范围环境中的精细的细节</p></li><li><p>介绍一些其他人的工作</p><p>寻找两帧激光点云间转换的方法，最典型是 ICP，也有很多变体，计算点到面，面到面，或使用并行计算等方式提高效率和准确性</p><p>一些基于特征的匹配方法(PFH、VFH等)；一些使用特征进行点云配准的算法</p><p>简单说明LOAM算法</p></li><li><p>本文的工作</p><p>为配备3D激光雷达的地面车辆寻求可靠的，实时的六自由度位姿估计，保证其方式适合在小型嵌入式系统中有效实施</p></li><li><p>工作不容易完成的原因</p><p>尺寸有限，许多无人车没有悬架和强大的计算单元</p><p>小型无人车在多变的地形行驶，常遇到非平滑的运动，获得的数据失真</p><p>由于有限重叠的大运动，连续扫面间难以找到可靠的特征对应关系</p><p>大量点的实时处理对有限的机载计算资源来说是个挑战</p></li><li><p>LOAM不适用的场景</p><p>LOAM在无人车平滑运动，即有稳定的特征，同时有足够的资源支持的条件下，结果是低漂移的；</p><p>但资源有限时性能会下降，特征提取的更新频率跟不上传感器的更新频率</p><p>因为安装位置距离地面较近，因此来自地面的噪声会持续存在；例如从草地和树叶上提取的点是不可靠的，因为两次连续扫描可能看不到同一片叶子；因此会导致不准确的配准和大的漂移</p></li><li><p>由5.引出我们提出的方法</p><p>一个轻量的，地面优化的LOAM，LeGO-LOAM，用于在可变地形的复杂环境中对无人车进行姿态估计</p><p>LeGO-LOAM是轻量的，因为可以在嵌入式系统上实现实时的位姿估计和建图</p><p>通过点云分割丢弃地面分离后可能代表不可靠特征的点</p><p>LeGO-LOAM是地面优化的，因为我们为位姿估计引入了两步优化</p><p>第一步，从地面提取的平面特征用于获得 [<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">t_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{roll}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">ll</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>p</mi><mi>i</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{pitch}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>]；第二步，通过匹配从分割点云中提取的边缘特征获得其余变换[<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">t_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">t_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>y</mi><mi>a</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{yaw}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>]</p><p>算法还集成了执行闭环以纠正运动估计漂移的能力，即回环检测模块</p></li><li><p>论文其余部分安排</p><p>第二节介绍硬件；第三节详细描述提出的方法；第四节介绍实验</p></li></ol><h3 id="II-SYSTEM-HARDWARE">II. SYSTEM HARDWARE</h3><p>介绍硬件参数，雷达和无人车</p><h3 id="III-LIGHTWEIGHT-LIDAR-ODOMETRY-AND-MAPPING">III. LIGHTWEIGHT LIDAR ODOMETRY AND MAPPING</h3><h4 id="A-System-Overview">A. System Overview</h4><p><img src="/2022/10/20/20221020/%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%BF%B0%E5%9B%BE.png" alt="系统概述图"></p><ol><li>接受点云数据，输出位姿估计</li><li><em>segmentation</em> 模块，采用单次扫描的点云并将其投影到范围图像上进行分割</li><li><em>feature extraction</em> 模块，进行特征点的提取</li><li><em>lidar odometry</em> 模块，求得相邻两帧之间的位姿转换</li><li><em>lidar mapping</em> 模块，进一步处理里程计得到的位姿变换，配准到全局地图</li><li><em>transform integration</em> 模块，融合里程计和建图模块的位姿估计结果，输出最终的位姿估计</li></ol><h4 id="B-Segmentation">B. Segmentation</h4><ol><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示时间 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 的点云，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 首先被投影到<code>距离图像</code>上</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">P_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中的每一个有效点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 被<code>距离图像</code>中的唯一像素表示</p></li><li><p>距离值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>r</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">r_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 到传感器的欧几里得距离</p></li><li><p>分割前，对<code>距离图像</code>逐列评估，可以认为是地面估计，用于提取地面点</p></li><li><p>这个过程之后，可能代表地面的点被标记为地面点，不用于分割</p></li><li><p>使用基于图像的分割方法，将<code>距离图像</code>划分为多个组</p></li><li><p>同一组的点有唯一的标签，地面点是一个特殊的组</p></li><li><p>点云分割能够提高处理效率和特征提取精度</p></li><li><p>为了使用分割后的点云进行快速可靠的特征提取，丢弃 &lt; 30个点的组</p></li><li><p>分割之后，只有剩余的点仍保存在<code>距离图像</code>中</p></li><li><p>对于<code>距离图像</code>中仍存在的点，会已知每个点的三个属性：</p><p>作为地面点或其他分割点的标签</p><p>在<code>距离图像</code>中的行列索引</p><p>该点的距离值</p></li></ol><p><img src="/2022/10/20/20221020/%E7%82%B9%E4%BA%91%E5%88%86%E5%89%B2%E5%89%8D%E5%90%8E%E5%AF%B9%E6%AF%94.png" alt="点云分割前后对比"></p><ol><li>上图为一帧点云分割前后特征点的对比图，其中 (a) 为原始图像</li><li>(b) 中，红色点被标记为地面点，其余点是分割后仍保留的点</li><li>© 中，蓝色的点为边缘特征，黄色的点为平面特征( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">F_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">F_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> )</li><li>(d) 中，绿色的点为边缘特征，粉色的点为平面特征( <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F} _e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F} _p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span> )</li></ol><h4 id="C-Feature-Extraction">C. Feature Extraction</h4><ol><li><p>特征提取的方式与LOAM类似，区别在于不从原始点云中提取，而是从地面点和分割点中提取</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 是<code>距离图像</code>同一行中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的连续点集，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 中一半的点在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的两边？？？</p></li><li><p>本文设置 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">∣</mo><mi>S</mi><mo fence="true">∣</mo></mrow><annotation encoding="application/x-tex">\left| S \right|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose delimcenter" style="top:0em;">∣</span></span></span></span></span> = 10，使用距离值计算<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> 中 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 的平滑度，公式为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow><mo fence="true">∣</mo><mi>S</mi><mo fence="true">∣</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><msub><mi>r</mi><mi>i</mi></msub><mo fence="true">∥</mo></mrow></mrow></mfrac><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mi>S</mi><mo separator="true">,</mo><mi>j</mi><mo mathvariant="normal">≠</mo><mi>i</mi></mrow></munder><mrow><mo fence="true">(</mo><msub><mi>r</mi><mi>j</mi></msub><mo>−</mo><msub><mi>r</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow><annotation encoding="application/x-tex">c=\frac{1}{\left| S \right|\cdot \left\| r_i \right\|}\left\| \sum_{j\in S,j\ne i}{\left( r_j-r_i \right)} \right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.6em;vertical-align:-1.55em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">∥</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">∥</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.556em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="3.600em" viewbox="0 0 556 3600"><path d="M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43zM367 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v2400 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.556em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="3.600em" viewbox="0 0 556 3600"><path d="M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43zM367 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v2400 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>为了从所有方向均匀提取特征，将距离图像水平地分为几个相等的子图</p></li><li><p>根据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值对子图中的每一行进行排序；与LOAM类似，设置阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 区分点的特征类型， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>&gt;</mo><msub><mi>c</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c&gt;c_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为边缘点， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi><mo>&lt;</mo><msub><mi>c</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c&lt;c_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5782em;vertical-align:-0.0391em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为平面点</p></li><li><p>从子图的每一行中选择不属于地面点，且具有最大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值的点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi mathvariant="double-struck">F</mi><mi>e</mi></msub></msub></mrow><annotation encoding="application/x-tex">n_{\mathbb{F} _e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6807em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span> 作边缘点；<strong>在地面点或分割点中取</strong>具有最小 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值的点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></msub></mrow><annotation encoding="application/x-tex">n_{\mathbb{F} _p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em;"><span></span></span></span></span></span></span></span></span></span> 作<strong>平面点</strong>；最终获得边缘点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F} _e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和平面点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">\mathbb{F} _p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>从子图的每一行中选择不属于地面点，且具有最大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值的点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi>F</mi><mi>e</mi></msub></msub></mrow><annotation encoding="application/x-tex">n_{F_e}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6807em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span></span></span></span> 作边缘点；<strong>必须在地面点中取</strong>具有最小 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值的点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi>F</mi><mi>p</mi></msub></msub></mrow><annotation encoding="application/x-tex">n_{F_p}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em;"><span></span></span></span></span></span></span></span></span></span> 作<strong>平面点</strong>；最终获得边缘点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">F_e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和平面点集 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">F_p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>【注】6，7在平面点选取上有不同，显然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>e</mi></msub><mo>⊂</mo><msub><mi mathvariant="double-struck">F</mi><mi>e</mi></msub></mrow><annotation encoding="application/x-tex">F_e\subset \mathbb{F} _e</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mi>p</mi></msub><mo>⊂</mo><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></mrow><annotation encoding="application/x-tex">F_p\subset \mathbb{F} _p</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9694em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">⊂</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.975em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>论文将 360° 的<code>距离图像</code>分为 6 个子图，每个子图为 300 × 16，并设置各类点的数量： <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi>F</mi><mi>e</mi></msub></msub><mo>=</mo><mn>2</mn></mrow><annotation encoding="application/x-tex">n_{F_e} = 2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6807em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">2</span></span></span></span> ， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi>F</mi><mi>p</mi></msub></msub><mo>=</mo><mn>4</mn></mrow><annotation encoding="application/x-tex">n_{F_p} = 4</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:-0.1389em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">4</span></span></span></span> ， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi mathvariant="double-struck">F</mi><mi>e</mi></msub></msub><mo>=</mo><mn>40</mn></mrow><annotation encoding="application/x-tex">n_{\mathbb{F} _e} = 40</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6807em;vertical-align:-0.2501em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.143em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2501em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">40</span></span></span></span> ， <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>n</mi><msub><mi mathvariant="double-struck">F</mi><mi>p</mi></msub></msub><mo>=</mo><mn>80</mn></mrow><annotation encoding="application/x-tex">n_{\mathbb{F} _p} = 80</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7779em;vertical-align:-0.3473em;"></span><span class="mord"><span class="mord mathnormal">n</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3322em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight"><span class="mord mathbb mtight">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1645em;"><span style="top:-2.357em;margin-left:0em;margin-right:0.0714em;"><span class="pstrut" style="height:2.5em;"></span><span class="sizing reset-size3 size1 mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2819em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3473em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">80</span></span></span></span></p></li></ol><h4 id="D-Lidar-Odometry">D. Lidar Odometry</h4><ol><li><p>里程计通过在上一帧中找当前帧特征点的对应关系，估计相邻两帧间的运动，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>e</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{e}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>p</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{p}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1767em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> 分别在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{e}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{p}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1972em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> 中找对应特征，具体过程参照LOAM</p></li><li><p>相比于LOAM，进行了一些改变提高特征匹配的准确度和效率(3.和4.)</p></li><li><p>标签匹配，因为分割后的每个特征点都有标签，只需在上一帧相同标签下找对应匹配关系即可</p></li><li><p>两步LM优化(<strong>分两步找到最优变换T</strong>)</p><p>step1：匹配 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>p</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{p}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1767em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> 的平面特征在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{p}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1972em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> 中的对应关系，估计 [<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">t_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{roll}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">ll</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>p</mi><mi>i</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{pitch}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>]</p><p>step2：匹配 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>F</mi><mi>e</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">F_{e}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 的边缘特征在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{e}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0611em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> 中的对应关系，同时 [<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>z</mi></msub></mrow><annotation encoding="application/x-tex">t_z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.04398em;">z</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>r</mi><mi>o</mi><mi>l</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{roll}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ro</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">ll</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>p</mi><mi>i</mi><mi>t</mi><mi>c</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{pitch}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>]作为约束条件，估计 [<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>x</mi></msub></mrow><annotation encoding="application/x-tex">t_x</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">x</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> , <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>y</mi></msub></mrow><annotation encoding="application/x-tex">t_y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9012em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>θ</mi><mrow><mi>y</mi><mi>a</mi><mi>w</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\theta _{yaw}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9805em;vertical-align:-0.2861em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">θ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0278em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03588em;">y</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.02691em;">w</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2861em;"><span></span></span></span></span></span></span></span></span></span>]</p><p>融合二者结果获得连续两帧之间的六自由度变换</p><p>通过该方法，在实现相似精度的结果时，节约35%的计算时间(下文表Ⅲ)</p></li></ol><h4 id="E-Lidar-Mapping">E. Lidar Mapping</h4><ol><li><p>Mapping 将{ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{e}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{p}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1767em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> }与周围点云地图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 作特征匹配，再次使用LM方法，进一步优化位姿，具体过程与LOAM类似</p></li><li><p>区别在于最终点云地图的存储方式；LOAM存储单个点云地图，LeGO-LOAM存储每个特征集合{ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{e}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{p}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1767em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> }</p></li><li><p>使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mrow><mo fence="true">{</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mn>1</mn></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mn>1</mn></msubsup><mo fence="true">}</mo></mrow><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mrow><mo fence="true">{</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo fence="true">}</mo></mrow><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">M^{t-1}=\left\{ \left\{ \mathbb{F} _{e}^{1},\mathbb{F} _{p}^{1} \right\} ,\cdots ,\left\{ \mathbb{F} _{e}^{t-1},\mathbb{F} _{p}^{t-1} \right\} \right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2331em;vertical-align:-0.3831em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span> ，是保存先前所有特征集的集合，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">M^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 中的每个特征集与扫描时传感器的位姿相关</p></li><li><p>周围地图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 可以通过两种方式从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>M</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">M^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8141em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.10903em;">M</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 中获得</p></li><li><p>方法一：通过选择传感器视野范围内的特征集合获得</p><p>选择位姿在雷达当前位置100米内的特征集合，将选择的特征集合转换并融合成周围地图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> ，这种方式与LOAM类似</p></li><li><p>方法二：将位姿图集成到LeGO-LOAM中</p><p>每个特征集合的位姿建模为位姿图中的一个节点，特征集合{ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{e}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0406em;vertical-align:-0.247em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mi>t</mi></msubsup></mrow><annotation encoding="application/x-tex">\mathbb{F} _{p}^{t}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1767em;vertical-align:-0.3831em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.7936em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span></span></span></span> } 视为该节点的测量值</p><p>Mapping中位姿估计的漂移极低，可假定为没有漂移</p><p>选最近的特征集生成 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> ，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup><mo>=</mo><mrow><mo fence="true">{</mo><mrow><mo fence="true">{</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mi>k</mi></mrow></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mi>k</mi></mrow></msubsup><mo fence="true">}</mo></mrow><mo separator="true">,</mo><mo>⋯</mo><mtext> </mtext><mo separator="true">,</mo><mrow><mo fence="true">{</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>e</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo separator="true">,</mo><msubsup><mi mathvariant="double-struck">F</mi><mi>p</mi><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo fence="true">}</mo></mrow><mo fence="true">}</mo></mrow></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}=\left\{ \left\{ \mathbb{F} _{e}^{t-k},\mathbb{F} _{p}^{t-k} \right\} ,\cdots ,\left\{ \mathbb{F} _{e}^{t-1},\mathbb{F} _{p}^{t-1} \right\} \right\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2331em;vertical-align:-0.3831em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8491em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">⋯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size1">{</span></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">e</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.247em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathbb">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-2.453em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">p</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3831em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size1">}</span></span></span></span></span></span>,其中 k 定义为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 的大小？？？</p></li><li><p>获得周围地图后，使用LM优化结果添加 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mover accent="true"><mi>Q</mi><mo>ˉ</mo></mover><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msup></mrow><annotation encoding="application/x-tex">\bar{Q}^{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0145em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.1944em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8141em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span></span></span></span></span></span></span></span> 中新节点和所选节点之间的空间约束</p></li><li><p>可通过回环检测进一步消除该模块的漂移</p></li><li><p>如果使用ICP在当前特征集与先前特征集间找到匹配，则添加新的约束</p></li><li><p>将位姿图发送到优化系统更新雷达位姿</p><p>【注】只在Sec.Ⅳ(D)的实验中使用这种技术创建周围地图</p></li></ol><h3 id="IV-EXPERIMENTS">IV. EXPERIMENTS</h3><p>进行一系列实验，定性和定量分析LOAM和LeGO-LOAM</p><h4 id="A-Small-Scale-UGV-Test">A. Small-Scale UGV Test</h4><p>在植被覆盖的室外环境比较特征提取效果，进行定性分析</p><p><img src="/2022/10/20/20221020/%E4%B8%A4%E7%AE%97%E6%B3%95%E7%89%B9%E5%BE%81%E6%8F%90%E5%8F%96%E5%AF%B9%E6%AF%94.png" alt="两算法特征提取对比"></p><ol><li>LeGO-LOAM在点云分割后，特征点的数量相比LOAM大大减少</li><li>树叶，草地有较大 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值，LOAM不可避免的从中提取边缘特征，这些特征是不可靠的</li><li>虽然可以通过修改LOAM中的平滑度阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 以过滤掉不稳定的特征，但实际应用后获得的效果却更差</li><li>提升阈值虽然能从环境中提取更稳定的边缘特征，但当机器人进入相对整洁的环境后，可能导致提取到的可用的边缘特征数量不足，平面特征同理，因此在所有实验中，LOAM和LeGO-LOAM均使用相同阈值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>c</mi><mrow><mi>t</mi><mi>h</mi></mrow></msub></mrow><annotation encoding="application/x-tex">c_{th}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">c</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">h</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li></ol><p><img src="/2022/10/20/20221020/%E4%B8%A4%E7%AE%97%E6%B3%95%E8%8D%89%E5%9C%B0%E5%BB%BA%E5%9B%BE%E5%AF%B9%E6%AF%94.png" alt="两算法草地建图对比"></p><ol><li>对特征提取时的草地建图，能看到LOAM由于不稳定特征导致的错误特征关联现象(白色箭头标出)</li><li>LOAM的地图出现发散，白色箭头突出显示的三棵树实际为同一棵树</li></ol><h4 id="B-Large-Scale-UGV-Tests">B. Large-Scale UGV Tests</h4><p>在三个大规模数据集上对LOAM和LeGO-LOAM进行定量分析，每个实验的性能和准确性结果都取自十次以上实验的平均值</p><p><img src="/2022/10/20/20221020/%E5%AE%9E%E9%AA%8C%E4%B8%80%E8%B7%AF%E5%BE%84.png" alt="实验一路径"></p><ol><li>实验一的目的在于证明LOAM和LeGO-LOAM都可以在平滑运动下的城市环境中实现低漂移位姿估计</li><li>因此实验一避免激进的偏航动作，避免穿过稳定特征少的稀疏区域，全程运行在平坦道路上</li><li>初始位置与结束位置相同；为评估两种算法的位姿估计准确度，通过最终位姿与起始位姿间的平移和旋转差异，结果证明两算法实现了相似的低漂移位姿估计</li></ol><p><img src="/2022/10/20/20221020/%E5%AE%9E%E9%AA%8C%E4%BA%8C%E8%B7%AF%E5%BE%84.png" alt="实验二路径"></p><ol><li><p>实验二与实验一是相同环境，但轨迹略有不同，实验二有一个人行道，这就是LOAM可能经常失败的环境</p></li><li><p>人行道一端是墙和柱子，这些结构提取的特征是稳定的；另一端是开阔区域，覆盖了草和树等噪声较大的物体，这些结构提取的特征是不稳定的</p></li><li><p>LOAM的位姿估计在穿过这样的人行道后会发散，LeGO-LOAM则：</p><p>不从草覆盖的地面提取边缘特征</p><p>分割后过滤掉来自树叶的噪声</p></li><li><p>在本实验中，LeGO-LOAM 的精度比 LOAM 高一个数量级</p></li></ol><p><img src="/2022/10/20/20221020/%E5%AE%9E%E9%AA%8C%E4%BA%8C%E5%B1%80%E9%83%A8%E5%AF%B9%E6%AF%94.png" alt="实验二局部对比"></p><p><img src="/2022/10/20/20221020/%E5%AE%9E%E9%AA%8C%E4%B8%89%E5%9C%B0%E5%BD%A2.png" alt="实验三地形"></p><ol><li>实验三使用森林小路的数据集进行测试，无人车在三种路面上行驶：泥土覆盖的路，柏油路，草覆盖的地面(分别为上图中 a, b, c)；这保证了至少道路一侧始终存在树木或灌木丛</li><li>运行结果如下图所示，显然LeGO-LOAM的误差性比LOAM要低得多，同时LeGO-LOAM的在所有路径间显示出高度一致性</li></ol><p><img src="/2022/10/20/20221020/%E5%AE%9E%E9%AA%8C%E4%B8%89%E7%BB%93%E6%9E%9C.png" alt="实验三结果"></p><h4 id="C-Benchmarking-Results">C. Benchmarking Results</h4><ol><li><p>特征点数量比较</p><p><img src="/2022/10/20/20221020/%E7%89%B9%E5%BE%81%E7%82%B9%E6%95%B0%E9%87%8F%E6%AF%94%E8%BE%83.png" alt="特征点数量比较"></p><p><strong>结果：</strong> 需处理的四种特征点分别减少 29%、40%、68% 和 72%</p></li><li><p>迭代次数比较</p><p><strong>原始LM优化</strong>与本文提出的<strong>两步LM优化</strong>进行对比，以处理一帧的平均迭代次数作为判断标准</p><p><img src="/2022/10/20/20221020/%E4%B8%A4%E6%AD%A5LM%E4%BC%98%E5%8C%96%E7%9A%84%E8%BF%AD%E4%BB%A3%E6%95%88%E6%9E%9C.png" alt="两步LM优化的迭代效果"></p><p>两步LM中第一步次数在一到两次迭代，第二部虽然与原始LM优化次数相似，但处理的特征少</p><p><strong>结果为</strong>，运行时间减少了 34% 至 48%(见运行时间比较的表格)</p></li><li><p>运行时间比较</p><p>每个模块的运行时间见表Ⅳ</p><p><img src="/2022/10/20/20221020/%E8%BF%90%E8%A1%8C%E6%97%B6%E9%97%B4%E6%AF%94%E8%BE%83.png" alt="运行时间比较"></p><p><strong>结果：</strong> 特征提取和里程计模块的运行时间减少了一个数量级，Mapping的运行时间也至少减少60%</p><p>【注】在Jetson下，LOAM特征提取和里程计的运行时间超过100ms，有很多帧被跳过，因此LOAM在嵌入式系统上无法实现实时性</p></li><li><p>位姿误差比较</p><p>设置初始位姿为[0,0,0,0,0,0]，比较最终位姿和初始位姿间的位姿变换计算相对位姿误差(分为平移和旋转)</p><p><img src="/2022/10/20/20221020/%E7%9B%B8%E5%AF%B9%E4%BD%8D%E5%A7%BF%E8%AF%AF%E5%B7%AE%E6%AF%94%E8%BE%83(%E9%A6%96%E5%B0%BE%E5%9C%A8%E5%90%8C%E4%B8%80%E4%BD%8D%E7%BD%AE).png" alt="相对位姿误差比较(首尾在同一位置)"></p><p><strong>结果：</strong> 通过使用提出的框架，LeGO-LOAM可以在更少的计算时间条件下实现相当或更好的位姿估计精确度</p></li></ol><h4 id="D-Loop-Closure-Test-using-KITTI-Dataset">D. Loop Closure Test using KITTI Dataset</h4><p>用00数据集测试，位姿图进行优化，KITTI测试似乎只是为了看回环效果？？？</p><h3 id="V-CONCLUSIONS-AND-DISCUSSION">V. CONCLUSIONS AND DISCUSSION</h3><ol><li>本文提出了LeGO-LOAM，一种<strong>轻量的</strong>，<strong>地面优化</strong>的雷达里程计建图算法，用于在复杂环境中执行UGV的实时位姿估计</li><li>是轻量的，可以在嵌入式系统上使用并实现实时性</li><li>是地面优化的，利用<strong>地面分离，点云分割和改进的LM优化</strong>实现</li><li>地面分离和点云分割过滤掉不可靠特征的点，两步LM优化分别计算位姿变换的不同分量</li><li>提出的方法在室外环境中收集的一系列UGV数据集上进行评估</li><li><strong>实验结果表明，与最先进的LOAM算法相比，LeGO-LOAM可以达到相似或更好的精度，同时计算时间大幅减少</strong></li></ol>]]></content>
      
      
      <categories>
          
          <category> SLAM论文阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> LeGO-LOAM </tag>
            
            <tag> 论文阅读 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>LOAM论文阅读</title>
      <link href="/2022/10/13/20221013/"/>
      <url>/2022/10/13/20221013/</url>
      
        <content type="html"><![CDATA[<h1>LOAM论文阅读</h1><h2 id="整体总结">整体总结</h2><p><strong>主要工作</strong>：提出一种实时的里程计和建图算法</p><p><strong>核心思想</strong>：划分SLAM问题，使用并行算法<code>里程计</code>和<code>Mapping</code>结合，通过特征匹配和优化变量解决 SLAM 问题，同时保证实时性</p><p><strong>算法结果</strong>：准确度高，实时性好，KITTI 排名第一</p><h2 id="论文精读">论文精读</h2><h3 id="Abstract">Abstract</h3><ol><li><p>论文工作：提出一种实时的里程计和建图的方法</p></li><li><p>特点：实现低漂移和低计算复杂度；不需要高精度测量和惯性测量</p></li><li><p>关键思想：通过两个算法划分 SLAM 问题，同时优化大量变量</p><p>高频率低精度，估计激光雷达速度</p><p>低频率高精度，点云精配准</p></li><li><p>效果：KITTI测试，达到最先进的离线批处理方法水平的准确性</p></li></ol><h3 id="Ⅰ-INTRODUCTION">Ⅰ. INTRODUCTION</h3><ol><li><p>使用激光雷达建图很常见，高频范围测量，误差相对恒定，但雷达在移动，构建精确的地图就要知道测量期间雷达的位姿</p></li><li><p>常用的两种方式：</p><p>独立的位置估计，将激光点配准到固定坐标系(GPS/INS)</p><p>里程计测量配准激光点(轮式编码器/视觉里程计)</p></li><li><p>里程计随时间推移产生漂移，因此如何减少漂移</p></li><li><p>使用激光雷达的一个关键优势是它对场景中的环境照明和光学纹理不敏感</p></li><li><p>本文方法旨在推动与<strong>里程估计中的漂移最小化</strong>相关的问题，因此不涉及回环的问题</p></li><li><p>IMU不必要，但如果可用，可提供运动先验以帮助解决高频运动</p></li><li><p>两种算法都提取边缘和平面上的特征点，并分别与边缘线段和平面匹配</p></li><li><p>里程计算法中，保证快速计算的前提下，找到特征点的对应关系</p></li><li><p>Mapping算法中，检查局部点云的几何分布，通过关联的特征值和特征向量确定对应关系</p></li><li><p>通过对原始问题分解，首先是在线运动估计，之后进行批量优化产生高精度的运动估计和地图</p></li><li><p>并行算法结构保证了问题实时求解的可行性</p></li><li><p>运动估计频率高，就给了Mapping充足的时间增加准确度</p></li><li><p>频率较低时，Mapping算法能合并大量特征点，并使用足够多的迭代来收敛</p></li></ol><h3 id="Ⅱ-RELATED-WORK">Ⅱ. RELATED WORK</h3><ol><li>激光雷达扫描速率高于外部运动时，扫描时的运动失真可以忽略，此时就可以使用ICP进行点云匹配</li><li>提出一种两步法消除失真，在ICP之后，使用估计的速度进行失真补偿</li><li>对单轴雷达来说，如果扫描运动相对缓慢，失真就比较严重，双轴雷达更是如此，因为一个轴通常比另一个轴慢得多</li><li>如果有其他传感器可用时，通常使用滤波解决这个问题</li><li>一些论文中使用视觉特征恢复小车的运动，本文与他们一部分类似，在里程计算法中使用了线性运动模型</li><li>那些算法涉及强度图的视觉特征，同时需要密集的点云，而本文的算法在笛卡尔空间中提取并匹配几何特征，对点云的密度要求也较低</li><li>Bosse等人提出结合 IMU 和回环的方式创建地图，但不能用于实时的处理</li><li>本文提出的算法在地图质量上和他们相似，区别在于本文方法为自主车辆导航提供运动估计</li></ol><h3 id="Ⅲ-NOTATIONS-AND-TASK-DESCRIPTION">Ⅲ. NOTATIONS AND TASK DESCRIPTION</h3><p>论文中符号描述</p><h3 id="Ⅳ-SYSTEM-OVERVIEW">Ⅳ. SYSTEM OVERVIEW</h3><h4 id="雷达硬件">雷达硬件</h4><ol><li>本文使用的3D激光雷达由一个激光扫描仪和一个编码器组成</li><li>激光扫描仪由电机驱动从-90°~90°旋转，编码器测量旋转角度 n</li><li>分辨率为0.25°，扫描速率为 40线/s</li></ol><h4 id="软件系统">软件系统</h4><p><img src="/2022/10/13/20221013/%E8%AE%BA%E6%96%87%E7%AE%97%E6%B3%95%E6%B5%81%E7%A8%8B%E5%9B%BE.png" alt="论文算法流程图"></p><ol><li>扫描到的每一个点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi></mrow><annotation encoding="application/x-tex">P</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span></span> 配准到坐标系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>L</mi></mrow><annotation encoding="application/x-tex">L</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">L</span></span></span></span> 中，扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 期间的点形成点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>里程计计算雷达在两次连续扫描期间的运动</li><li>估计的运动用于校正 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中的畸变</li><li>里程计算法以 10Hz 频率运行</li><li>Mapping 算法进一步处理里程计的输出，以 1Hz 频率运行，将校正过的点云配准到地图上</li><li>将两算法发布的位姿结合，生成相对于地图的位姿，即 10Hz 左右的变换输出</li></ol><h3 id="Ⅴ-LIDAR-ODOMETRY">Ⅴ. LIDAR ODOMETRY</h3><h4 id="特征点提取">特征点提取</h4><ol><li><p>定义 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 作为评价局部平面平滑度的指标</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>c</mi><mo>=</mo><mfrac><mn>1</mn><mrow><mrow><mo fence="true">∣</mo><mi>S</mi><mo fence="true">∣</mo></mrow><mo>⋅</mo><mrow><mo fence="true">∥</mo><msubsup><mi>X</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">∥</mo></mrow></mrow></mfrac><mrow><mo fence="true">∥</mo><munder><mo>∑</mo><mrow><mi>j</mi><mo>∈</mo><mi>S</mi><mo separator="true">,</mo><mi>j</mi><mo mathvariant="normal">≠</mo><mi>i</mi></mrow></munder><mrow><mo fence="true">(</mo><msubsup><mi>X</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mi>X</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo fence="true">∥</mo></mrow></mrow><annotation encoding="application/x-tex">c=\frac{1}{\left| S \right|\cdot \left\| X_{\left( k,i \right)}^{L} \right\|}\left\| \sum_{j\in S,j\ne i}{\left( X_{\left( k,i \right)}^{L}-X_{\left( k,j \right)}^{L} \right)} \right\|</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.74em;vertical-align:-1.69em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;">∣</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mclose delimcenter" style="top:0em;">∣</span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="1.800em" viewbox="0 0 556 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.556em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="1.800em" viewbox="0 0 556 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43zM367 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.827em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.556em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="3.600em" viewbox="0 0 556 3600"><path d="M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43zM367 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v2400 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.05em;"><span style="top:-1.8479em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight">∈</span><span class="mord mathnormal mtight" style="margin-right:0.05764em;">S</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mrel mtight"><span class="mrel mtight"><span class="mord vbox mtight"><span class="thinbox mtight"><span class="rlap mtight"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="inner"><span class="mord mtight"><span class="mrel mtight"></span></span></span><span class="fix"></span></span></span></span></span><span class="mrel mtight">=</span></span><span class="mord mathnormal mtight">i</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.4382em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.428em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.447em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.428em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.447em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.05em;"><span style="top:-4.05em;"><span class="pstrut" style="height:5.6em;"></span><span style="width:0.556em;height:3.600em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.556em" height="3.600em" viewbox="0 0 556 3600"><path d="M145 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v2400 v585 h43zM367 15 v585 v2400 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-2400 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v2400 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.55em;"><span></span></span></span></span></span></span></span></span></span></span></span></p></li><li><p>根据 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值对扫描的点进行排序,<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值大的为边缘点，小的为平面点</p></li><li><p>为了在环境中均匀分布特征点，将扫描分为四个子区域，每个子区域最多提供 2 个边缘点和 4 个平面点</p></li><li><p>一个点只有在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 值大于或小于某个阈值，且被选择的点数量不超过最大值时，才能被选为边缘点或平面点</p></li><li><p>避免选择<code>已选中点</code>周围的点，或激光束大致平行的局部平面上的点，因为通常认为这些点时不可靠的，如下图(a)所示</p></li><li><p>不能选遮挡区域边界上的点，被遮挡的地方换个角度可能会可见，因此要避免选择，如下图(b)所示</p></li></ol><p><img src="/2022/10/13/20221013/%E8%AE%BA%E6%96%87%E9%81%BF%E5%85%8D%E9%80%89%E6%8B%A9%E7%9A%84%E7%82%B9.png" alt="论文避免选择的点"></p><p>总结，如果一个点能被选中，一定要满足下列条件：</p><ul><li>选择的边缘点和平面点的数量不超过子区域的最大值</li><li>其周围的点没有被选中</li><li>不位于与激光束大致平行的曲面上，也不位于遮挡区域的边界上</li></ul><h4 id="寻找特征点对应关系">寻找特征点对应关系</h4><p><img src="/2022/10/13/20221013/%E7%82%B9%E4%BA%91%E9%87%8D%E6%8A%95%E5%BD%B1.png" alt="点云重投影"></p><ol><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">t_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 开始的时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 为扫描过程中感知到的点云</li><li>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">P_k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 重投影到时间戳 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ，设为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li><li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和下一次扫描得到的点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 一起，估计雷达运动</li><li>在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 中找边缘点和平面点，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中找边缘线和平面作为对应关系</li><li>分别用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">E</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{E} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{H} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0097em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 表示 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 中边缘点和平面点集合</li><li>每次迭代，使用当前估计的变换将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">E</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{E} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{H} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0097em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 重新投影到扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 的开始，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 时刻，设为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">E</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{E}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.08944em;">E</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">H</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{H}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.00965em;">H</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li><li>对于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">E</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{E}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.08944em;">E</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">H</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{H}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.00965em;">H</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 中的每个点，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中找到最近邻点，此时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 存储在KDTree 中用于快速索引</li></ol><p><img src="/2022/10/13/20221013/%E9%87%8C%E7%A8%8B%E8%AE%A1%E5%8C%B9%E9%85%8D%E5%85%B3%E7%B3%BB%E5%9B%BE.png" alt="里程计匹配关系图"></p><p><strong>(a)是边缘点找对应边缘线的过程</strong></p><ol><li>匹配的边缘点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 属于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">E</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{E}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.08944em;">E</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ，边缘线使用<strong>两个点</strong>表示</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中的最近邻；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> 是在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 相邻扫描线上的 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 的最近邻</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">(</mo><mi>j</mi><mo separator="true">,</mo><mi>l</mi><mo fence="true">)</mo></mrow><annotation encoding="application/x-tex">\left(j,l\right)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span> 构成了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 的对应关系</li><li>考虑到单次扫描不会包含来自同一条边缘线上的多个点，因此要求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> 的选择不能来自同一条扫描线</li><li>只有一个例外就是边缘线在扫描平面上；但如果这样，边缘线会退化，在扫描平面上显示为一条直线，这样的话边缘线上的特征点一开始就不会被提取</li><li>为了验证 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> 都是边缘点，基于曲率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 再次检查曲面光滑度</li></ol><p><strong>(b) 是平面点找对应平面的过程</strong></p><ol><li>匹配的平面点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 属于 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi><mover><mo><mi mathvariant="script">H</mi></mo><mo lspace="0em" rspace="0em">∼</mo></mover></mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overset{\sim}{\mathcal{H}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.4485em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord"><span class="mop op-limits"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:1.2401em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop mathcal" style="margin-right:0.00965em;">H</span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mrel mtight">∼</span></span></span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ，平面使用<strong>三个点</strong>表示</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中的最近点；<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 是满足要求时 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 的另外两个最近邻点</li><li>要求 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span> 与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 在同一条扫描线上，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 相邻的扫描线上</li><li>这样的要求保证了 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 是不共线的</li><li>为了验证 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi></mrow><annotation encoding="application/x-tex">j</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.854em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05724em;">j</span></span></span></span> 、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>l</mi></mrow><annotation encoding="application/x-tex">l</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.01968em;">l</span></span></span></span>、<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>m</mi></mrow><annotation encoding="application/x-tex">m</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">m</span></span></span></span> 都是平面点，基于曲率 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span> 再次检查曲面光滑度</li></ol><p><strong>特征点对应关系找到后，计算特征点到对应关系的距离</strong></p><p>对于边缘点，点到线的距离表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mi mathvariant="script">E</mi></msub><mo>=</mo><mfrac><mrow><mo fence="true">∣</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>~</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo>×</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>~</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>l</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mrow><mo fence="true">∣</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>l</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">∣</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">d_{\mathcal{E}}=\frac{\left| \left( \tilde{X}_{\left( k+1,i \right)}^{L}-\bar{X}_{\left( k,j \right)}^{L} \right) \times \left( \tilde{X}_{\left( k+1,i \right)}^{L}-\bar{X}_{\left( k,l \right)}^{L} \right) \right|}{\left| \bar{X}_{\left( k,j \right)}^{L}-\bar{X}_{\left( k,l \right)}^{L} \right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08944em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.88em;vertical-align:-1.69em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>计算原理为<code>平行四边形面积的两种计算方式</code>：</p><p><img src="/2022/10/13/20221013/%E9%87%8C%E7%A8%8B%E8%AE%A1%E7%82%B9%E7%BA%BF%E8%B7%9D%E7%A6%BB.png" alt="里程计点线距离"></p><p>平面点同理，残差使用点到面的距离，表示为：</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>d</mi><mi mathvariant="script">E</mi></msub><mo>=</mo><mfrac><mrow><mo fence="true">∣</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>~</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mrow><mo fence="true">(</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>l</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo>×</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow><mrow><mo fence="true">∣</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>l</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo>×</mo><mrow><mo fence="true">(</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>j</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>−</mo><msubsup><mover accent="true"><mi>X</mi><mo>ˉ</mo></mover><mrow><mo fence="true">(</mo><mi>k</mi><mo separator="true">,</mo><mi>m</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo fence="true">)</mo></mrow><mo fence="true">∣</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">d_{\mathcal{E}}=\frac{\left| \left( \tilde{X}_{\left( k+1,i \right)}^{L}-\bar{X}_{\left( k,j \right)}^{L} \right) \left( \left( \bar{X}_{\left( k,j \right)}^{L}-\bar{X}_{\left( k,l \right)}^{L} \right) \times \left( \bar{X}_{\left( k,j \right)}^{L}-\bar{X}_{\left( k,m \right)}^{L} \right) \right) \right|}{\left| \left( \bar{X}_{\left( k,j \right)}^{L}-\bar{X}_{\left( k,l \right)}^{L} \right) \times \left( \bar{X}_{\left( k,j \right)}^{L}-\bar{X}_{\left( k,m \right)}^{L} \right) \right|}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">d</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathcal mtight" style="margin-right:0.08944em;">E</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.88em;vertical-align:-1.69em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.19em;"><span style="top:-2.11em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8231em;"><span style="top:-2.3598em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.0448em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.5152em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.38em;"><span class="pstrut" style="height:3.15em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-4.19em;"><span class="pstrut" style="height:3.15em;"></span><span class="mord"><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9202em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.6023em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">~</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.0785em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">m</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size2">)</span></span></span><span class="mclose"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.15em;"><span style="top:-3.15em;"><span class="pstrut" style="height:3.8em;"></span><span style="width:0.333em;height:1.800em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.333em" height="1.800em" viewbox="0 0 333 1800"><path d="M145 15 v585 v600 v585 c2.667,10,9.667,15,21,15c10,0,16.667,-5,20,-15 v-585 v-600 v-585 c-2.667,-10,-9.667,-15,-21,-15c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v600 v585 h43z"/></svg></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.65em;"><span></span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p><p>计算原理为<code>已知点和法向量，点到面的距离公式</code>：</p><p><img src="/2022/10/13/20221013/%E9%87%8C%E7%A8%8B%E8%AE%A1%E7%82%B9%E9%9D%A2%E8%B7%9D%E7%A6%BB.png" alt="里程计点面距离"></p><h4 id="运动估计">运动估计</h4><ol><li><p>激光雷达在扫描过程中以恒定角速度和线速度建模，这使得可在扫描过程中，对不同时间接收到的点进行位姿变换的线性插值(运动补偿)</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> 为当前时间戳，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 是 k+1 扫描的起始时间，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">t_{i}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7651em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 是点 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span> 的时间戳</p></li><li><p><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><mi>t</mi><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[t_{k+1},t\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span> 间的雷达位姿变换，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{\left( k+1,i \right)}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3383em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span></span></span></span> 是 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo fence="true">[</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub><mo separator="true">,</mo><msub><mi>t</mi><mi>i</mi></msub><mo fence="true">]</mo></mrow><annotation encoding="application/x-tex">\left[t_{k+1},t_i\right]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">[</span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">]</span></span></span></span></span> 间的位姿变换</p></li><li><p>如下列公式所示，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{\left( k+1,i \right)}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3383em;vertical-align:-0.497em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.378em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.497em;"><span></span></span></span></span></span></span></span></span></span> 可通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 的线性插值进行计算</p></li></ol><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>T</mi><mrow><mo fence="true">(</mo><mi>k</mi><mo>+</mo><mn>1</mn><mo separator="true">,</mo><mi>i</mi><mo fence="true">)</mo></mrow><mi>L</mi></msubsup><mo>=</mo><mfrac><mrow><msub><mi>t</mi><mi>i</mi></msub><mo>−</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><mrow><mi>t</mi><mo>−</mo><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow></mfrac><msub><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">   T_{\left( k+1,i \right)}^{L}=\frac{t_i-t_{k+1}}{t-t_{k+1}}T_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.3383em;vertical-align:-0.447em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8913em;"><span style="top:-2.428em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="minner mtight"><span class="mopen mtight delimcenter" style="top:0em;"><span class="mtight">(</span></span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span><span class="mpunct mtight">,</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight delimcenter" style="top:0em;"><span class="mtight">)</span></span></span></span></span></span><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.447em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.1864em;vertical-align:-0.8943em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.2921em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.8943em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p><p><strong>里程计算法流程</strong></p><p><img src="/2022/10/13/20221013/%E9%87%8C%E7%A8%8B%E8%AE%A1%E7%AE%97%E6%B3%95.png" alt="里程计算法"></p><ol><li>算法输入：上一帧点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ，当前帧逐渐增长的点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> ，最近一次位姿变换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span></li><li>如果是扫描开始，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 置0 (若不是，则 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 是上一次的迭代结果)</li><li>从 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 中提取特征点，分别构造 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">E</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{E} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.08944em;">E</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0894em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">H</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{H} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.00965em;">H</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.0097em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li><li>对于每个特征点，在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi><mover><mo><msub><mi>P</mi><mi>k</mi></msub></mo><mo lspace="0em" rspace="0em">−</mo></mover></mi></mrow><annotation encoding="application/x-tex">\overset{-}{P_k}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.5417em;vertical-align:-0.15em;"></span><span class="mord"><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3917em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span><span class="mop"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span style="top:-3.8833em;margin-left:0em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">−</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 找匹配关系</li><li>运动估计适用于鲁棒拟合，因此根据点到特征的距离为每个特征点分配权重，距离远则权重低，距离近则权重高，距离大于阈值的点权重为0</li><li>位姿变换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 更新一次，即迭代一次</li><li>直到收敛或达到迭代次数，非线性优化终止</li><li>若算法到达扫描结束，则使用估计的变换将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 重投影到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 时刻；否则返回 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> ，用于下一次迭代</li></ol><h3 id="Ⅵ-LIDAR-MAPPING">Ⅵ. LIDAR MAPPING</h3><ol><li>Mapping 算法运行频率低于里程计算法；每次扫描只调用一次</li><li>扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 结束后，生成一个不失真的点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overline{P}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 和位姿变换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span></li><li>Mapping 算法将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overline{P}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 配准到世界坐标系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 下 (4.-6.)</li><li>使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 表示累积到扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 时的点云地图，使 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>k</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> 表示扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 结束时(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 时刻)雷达在地图中的位姿</li><li>利用里程计算法的输出，Mapping算法将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>k</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> 扩展到 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 至 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 的扫描中，以获得 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span></li><li>将 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\overline{P}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 映射到世界坐标系 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>W</mi></mrow><annotation encoding="application/x-tex">W</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span></span></span></span> 下，定义为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li><li>算法通过优化雷达位姿 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> 配准 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></li></ol><p><strong>过程示意图解释</strong></p><p><img src="/2022/10/13/20221013/Mapping%E7%AE%97%E6%B3%95%E8%BF%87%E7%A8%8B%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="mapping算法过程示意图"></p><ol><li>上图为 Mapping 算法过程示意图</li><li>蓝色曲线表示地图中雷达位姿 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>k</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> ，由 Mapping 算法在扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi></mrow><annotation encoding="application/x-tex">k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span></span></span></span> 生成</li><li>橙色曲线表示扫描 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">k+1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7778em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> 期间的雷达运动 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> ，由里程计算法求得</li><li>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>k</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> ，将里程计算法发布的未失真点云投影到地图上，表示为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi mathvariant="script">Q</mi><mo>ˉ</mo></mover><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{\mathcal{Q}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0284em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathcal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0972em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> (图中绿色线段)</li><li>与地图上现有的点云 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 匹配(图中黑色线段)</li></ol><p><strong>匹配过程解释</strong></p><ol><li><p>特征点提取方式与里程计部分相同，但使用了10倍数量的特征点</p></li><li><p>为找到特征点对应关系，在地图 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _k</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 中存储10m立方区域内的点云？？？</p></li><li><p>立方区域内与 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">Q</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{Q} _{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathcal">Q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 相交的点被提取并存储在 3D 的 KDTree 中</p></li><li><p>使用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">S</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{S} ^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 表示对应关系点的集合</p></li><li><p>对于边缘点，计算 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">S</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{S} ^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的协方差矩阵 M ，计算 M 的特征值 V 和特征向量 E</p><p>如果对应点呈线性分布，则 V 中最大特征向量会明显大于其他两个特征向量；<strong>E 中与最大特征值相关的特征向量即为对应边缘线的方向</strong></p></li><li><p>对于平面点，则 V 中应包含两个明显大于其他特征值的较大特征值；<strong>E 中与最小特征值相关的表示对应平面的方向</strong></p></li><li><p>对应边缘线和平面的位置均由 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi mathvariant="script">S</mi><mo mathvariant="normal" lspace="0em" rspace="0em">′</mo></msup></mrow><annotation encoding="application/x-tex">\mathcal{S} ^{\prime}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7519em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.075em;">S</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7519em;"><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">′</span></span></span></span></span></span></span></span></span></span></span></span> 的几何中心确定</p></li><li><p>为了计算特征点和对应关系的距离，在边缘线上选两个点，在平面上选三个点，这样可以使用与里程计算法同样的计算方式</p></li><li><p>不同的是，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi mathvariant="script">Q</mi><mo>ˉ</mo></mover><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\bar{\mathcal{Q}}_{k+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.0284em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8201em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathcal">Q</span></span><span style="top:-3.2523em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.1667em;"><span class="mord">ˉ</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.0972em;"><span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> 中的所有点使用相同的时间戳，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mrow><mi>k</mi><mo>+</mo><mn>2</mn></mrow></msub></mrow><annotation encoding="application/x-tex">t_{k+2}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8234em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathnormal">t</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></p></li></ol><p><strong>位姿变换与时间戳关系</strong></p><p><img src="/2022/10/13/20221013/%E4%BD%8D%E5%A7%BF%E5%8F%98%E6%8D%A2%E6%97%B6%E9%97%B4%E6%88%B3%E7%A4%BA%E6%84%8F%E5%9B%BE.png" alt="位姿变换时间戳示意图"></p><ol><li>上图为位姿变换的示意图</li><li>蓝色区域为 Mapping 算法输出的位姿 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mi>k</mi><mi>W</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k}^{W}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1244em;vertical-align:-0.2831em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">W</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2831em;"><span></span></span></span></span></span></span></span></span></span> ，每次扫描生成一次</li><li>橙色区域为里程计算法输出的位姿变换 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>T</mi><mrow><mi>k</mi><mo>+</mo><mn>1</mn></mrow><mi>L</mi></msubsup></mrow><annotation encoding="application/x-tex">T_{k+1}^{L}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1828em;vertical-align:-0.3414em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8413em;"><span style="top:-2.4169em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.063em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">L</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.3414em;"><span></span></span></span></span></span></span></span></span></span> ，频率约为10Hz</li><li>相对于地图的雷达位姿，是两种位姿变换的结合，频率与里程计相同</li></ol><h3 id="Ⅶ-EXPERIMENTS">Ⅶ. EXPERIMENTS</h3><h4 id="Indoor-Outdoor-Tests">Indoor &amp; Outdoor Tests</h4><ol><li><p>分别对室内和户外环境进行建图</p></li><li><p>为评估地图的局部准确性，从相同环境中收集第二组点云数据</p></li><li><p>第一组数据的特征点在第二组数据中找对应平面，二者距离作为匹配误差</p></li><li><p>结果表明室内比户外环境匹配误差小，结果合理，因为自然环境中的特征匹配不如人造环境中精确</p><p><img src="/2022/10/13/20221013/%E5%AE%A4%E5%86%85%E6%88%B7%E5%A4%96%E8%AF%AF%E5%B7%AE%E5%88%86%E5%B8%83%E5%AF%86%E5%BA%A6.png" alt="室内户外误差分布密度"></p></li><li><p>此外测量运动估计的累计漂移</p></li><li><p>室内环境选择有回环的走廊，这样可以保证起始点和结束点在同一位置，二者之间的间隙就代表漂移量</p></li><li><p>户外环境选择果园，使用高精度 GPS/INS 获取地面实况，将获得的漂移与行进距离作为相对精度进行比较，室内依然比户外误差小</p><p><img src="/2022/10/13/20221013/%E5%AE%A4%E5%86%85%E6%88%B7%E5%A4%96%E6%BC%82%E7%A7%BB%E9%87%8F.png" alt="室内户外漂移量"></p></li></ol><h4 id="Assistance-from-an-IMU">Assistance from an IMU</h4><ol><li><p>使用 IMU 解决快速的速度变化</p></li><li><p>点云数据在发送给我们提出的算法前有两种处理方式：</p><p>使用 IMU 方向，将一次扫描中的点云旋转与雷达初始位置对齐</p><p>使用加速度测量，部分消除失真，即匀速假设模型</p></li><li><p>通过卡尔曼滤波中角速度的积累和加速度计的值获得 IMU 方向</p></li><li><p>一个示例，三种方式</p><p><img src="/2022/10/13/20221013/IMU.png" alt="IMU"></p></li><li><p>表二给出三种模式下的误差，结果表明</p><p><img src="/2022/10/13/20221013/IMU%E8%BE%85%E5%8A%A9%E6%95%88%E6%9E%9C.png" alt="IMU辅助效果"></p><p>IMU 进行预处理，之后使用本文提出的算法，结果会更好</p><p>只使用 IMU 效果会更差</p></li></ol><h4 id="Tests-with-KITTI-Datasets">Tests with KITTI Datasets</h4><ol><li>使用 KITTI 的数据集进行测试</li><li>本文提出的方法在基准评估的所有方法中排名第一</li></ol><h3 id="VIII-CONCLUSION-AND-FUTURE-WORK">VIII. CONCLUSION AND FUTURE WORK</h3><ol><li>使用旋转的雷达扫描仪获得的点云进行运动估计和建图可能很困难，因为该问题涉及到点云中的运动恢复和运动失真校正</li><li>本文提出的方法通过两种并行运行的算法划分并解决上述问题：<strong>里程计算法以较高频率进行粗略处理以估计速度，Mapping 算法以较低频率进行精细处理以生成地图</strong></li><li>两种算法结合实现准确的运动估计和实时的建图</li><li>特征匹配保证了里程计算法的快速计算和 Mapping 算法的准确度</li><li>该方法已经过室内室外测试和 KITTI 的测试</li></ol>]]></content>
      
      
      <categories>
          
          <category> SLAM论文阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> 论文阅读 </tag>
            
            <tag> LOAM </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A-LOAM问题解决</title>
      <link href="/2022/10/03/20221003/"/>
      <url>/2022/10/03/20221003/</url>
      
        <content type="html"><![CDATA[<h1>A-LOAM问题解决</h1><h2 id="问题解决">问题解决</h2><p>该模块用于记录阅读代码过程中产生的问题，主要为概念及过程原因</p><h3 id="scanRegistration">scanRegistration</h3><ol><li><p>去除雷达距离过近的点</p><p>对于激光雷达,其过近的点由于落在车体上,过远的点已经非常稀疏,因此都需要被过滤掉</p></li><li><p>去除点云中的无效点</p><p>无效点是指坐标值为 NaN 的点，NaN表明测量传感器距离到该点的距离值是有问题的，可能是因为传感器太近或太远，实际过程中无法使用</p></li><li><p>-atan2()</p><p>为了使坐标轴的 Y 轴反向，与 bag 包坐标轴对应</p></li><li><p>待处理的点云开始及结束索引不考虑前后五个点</p><p>计算曲率要用到左右相邻的五个点，因此前五个和后五个无法计算曲率</p></li><li><p>每条扫描线分为六部分</p><p>对应论文中将点云按子区域划分的部分，每个部分单独提取，互不干扰，保证特征点均匀分布</p></li><li><p>降采样</p><p>A-LOAM使用 voxelGrid 滤波器，过程为：在点云数据中创建三维体素栅格，然后用每个体素的重心近似表示体素中的其它点(一个点表示栅格所有点)</p></li></ol><h3 id="laserOdometry">laserOdometry</h3><ol><li><p>KDTree</p><p>二叉查找树，根据不同维度指标值进行划分，用于查找最近邻点</p></li><li><p>KDTree的最近邻搜索算法</p><p>搜索，一直到叶子节点，获得树的搜索路径以及初始最近点</p><p>回溯，按搜索路径向上，更新搜索路径和最近点，直到路径为空</p></li><li><p>为什么ICP迭代两次</p><p>ICP迭代共两次，第一次的优化结果作为第二次优化的初始值，同时整体来看，每次求得的相邻两帧间位姿变换关系会作为下一次相邻两帧优化时的初始值；使用Ceres求解时会对求解的参数进行配置，在A-LOAM中设置Ceres的迭代次数为 4，也就是说两次ICP迭代，在Ceres优化过程中共迭代了八次(仅个人理解)</p></li><li><p>鲁棒核函数( Ceres相关 )</p><p>原因：由于误匹配等原因，将错误的误差项数据加入到优化过程中，但优化算法不能识别，只是将所有数据当作误差处理，而误差很大的数据梯度也很大，意味着调整与它相关的变量会使目标函数下降很多，因此算法会试图调整这个误差相关的变量，而忽略其它正确数据的影响，使优化算法专注于调整一个错误的值</p><p>处理：核函数保证每条边的误差不会过大，以掩盖掉其他数据，具体过程为在误差的二范数增长过快时，替换为增长没那么快的函数，同时保证自己的光滑性质(能求导)。因为该核函数使得整个优化结果更为鲁棒，因称为鲁棒核函数</p></li><li><p>去运动畸变</p><p>即运动补偿，就是把某点云 P 中所有点映射到同一时刻 t，消除由于车辆运动和雷达旋转导致的点云畸变现象</p><p>原因：扫描得到的一帧点云，不是在同一时刻得到的，不同时刻获得的点所处的坐标系已经不同，即变化之后的数据与原点不同，例如可能使原本水平的墙面表示出来是倾斜的，因此为了恢复原数据，需要进行补偿</p><p>处理方式：无其它传感器时常用匀速模型假设，补偿到起始时刻，具体实现为 slerp 球面线性插值</p></li><li><p>各坐标系之间是什么关系</p><p>雷达坐标系和世界坐标系的关系：前端里程计的目的就是估计雷达坐标系在世界坐标系中的位姿</p><p>点云数据所在的坐标系：每一帧点云所在的坐标系就是这一帧扫描时雷达所在的坐标系</p><p>初始位置时的雷达坐标系就是世界坐标系</p></li><li><p>在A-LOAM中，KDTree是如何找到最近点的</p><p>前端里程计直接根据距离找最近点，只要找到不太离谱的初值即可</p><p>后端优化使用上一次的估计变换待匹配的点，再根据距离找最近点</p></li><li><p>激光里程计是干什么的</p><p>激光里程计就是粗略的位姿估计，即高频率低精度的位姿，准确的说是估计雷达坐标系在世界坐标系中的位姿</p><p>参考博客的说法：前端里程计中涉及两个坐标系，<code>/camera_init</code> 以及 <code>/laser_odom</code> 系，可以理解为前端中的全局世界坐标系和载体坐标系，而前端里程计的工作就是通过匹配前后两帧点云来估计载体坐标系在世界坐标系中的位姿，这个估计是高频并且精度相对不高的</p></li><li><p>q_last_curr是谁转换到谁</p><p>目的是要知道当前雷达的姿态与上一帧的点云姿态相比的变化，即q_last_curr,t_last_curr</p><p>注意：读作curr到last的q，也就是curr在last坐标系下的旋转和位置，满足 q_last_curr*curr = last</p><p>实际过程只要统一即可，因为旋转矩阵是可逆的，<code>与旋转矩阵相乘</code>和<code>与旋转矩阵的转置相乘</code>可得到从 A-&gt;B 以及从 B-&gt;A 的旋转</p></li><li><p>怎么得到当前帧在世界坐标系下的位姿</p><p>默认初始位置是世界坐标系下的原点，坐标系就是世界坐标系；之后通过与每次优化得到的位姿变换相乘，获得那一帧的世界坐标系下的位姿，不断相乘，就得到了每一帧在世界坐标系下的位姿</p></li></ol><h3 id="laserMapping">laserMapping</h3><ol><li><p>坐标系间的关系</p><p>参考博客的说法：后端建图中也涉及两个坐标系，<code>/camera_int</code> 以及 <code>/aft_mapped</code> 系，同样也可以理解为后端中的全局世界坐标系以及载体坐标系，后端的工作是通过将点云以及全局地图进行匹配来估计 <code>/aft_mapped</code> 系在 <code>/camera_int</code> 中的位姿，相对于前端频率较低，但精度较高。可以想象的是后端估计的位姿和前端估计的位姿有一定差异，因此后端中还维护一个转换矩阵（<code>wmap_T_odom</code>），用来将从前端接收到的位姿估计转换至后端估计的位姿，即对前端里程计估计的位姿进行修正</p></li><li><p>保证实时性</p><p>后端优化及建图耗费的时间较长，为了保证实时性，每次接收到<code>前端里程计给出的估计</code>，直接取出<code>后端得到的上一个对里程计位姿的修正</code>，二者相乘，直接输出，作为<code>后端实时的位姿估计</code></p></li><li><p>前后端特征点匹配的区别</p><p><strong>边缘点：</strong></p><p>前端使用<code>当前点</code>与<code>两最近点构成的直线</code>作残差求解</p><p>后端使用<code>当前点</code>与<code>最近五个点特征向量方向上构建的两虚拟点</code>作残差</p><p><strong>平面点：</strong></p><p>前端使用<code>当前点</code>与<code>三个最近点组成的平面</code>作残差</p><p>后端使用<code>当前点</code>与<code>五个最近点拟合出的平面</code>作残差</p></li><li><p>PCA原理</p><p>后端优化过程中边缘点的匹配与前端里程计不同，后端优化找五个最近点</p><p>PCA原理在这儿是指：五个最近点如果满足线状分布，则中心点矩阵的最大的特征值会比另外两个都大，程序中使用3倍作为衡量的标准，即最大特征值 &gt; 3×次大特征值；同时特征向量表明线状分布的直线的方向</p></li><li><p>为什么后端优化和前端里程计中特征点匹配过程不同</p><p>对边缘点来说，点到线的ICP过程要比里程计中的更加鲁棒和准确(同时也更耗时)，因为不是简单粗暴地搜索最近的 <strong>2</strong> 个边缘点作为匹配的线，而是PCA 计算出最近邻的 <strong>5</strong> 个点的主方向作为线的方向，而且还会check直线是不是“足够直”(即三倍标准作判断)</p><p>对于平面点来说，点到面的ICP过程同样比里程计中的要鲁棒和准确(同时也更耗时)，因为不是简单粗暴地搜最近的 3 个平面点构成匹配的平面，而是对最近邻的5个点进行基于最小二乘的平面拟合，而且还会check拟合出的平面是不是“足够平”(即五个点中每个点到平面的距离 &lt; 0.2)</p></li><li><p>cube中的点云是怎么提取的</p><p>每次将匹配的边缘点和平面点转换到世界坐标系下，存入到cube中，不断累加，用于提供后续待匹配的点云</p></li><li><p>点云是以帧的形式存储，怎么转变为以空间划分的cube形式</p><p>每次处理完后，将加入的边缘点和平面点逐个遍历，根据坐标计算其应归属的栅格，而后存入到栅格中</p></li></ol><h2 id="数据变化总结">数据变化总结</h2><h3 id="整体数据流向">整体数据流向</h3><p><img src="/2022/10/03/20221003/aloam%E8%8A%82%E7%82%B9%E5%9B%BE.png" alt="aloam节点图"></p><h3 id="各节点中数据变化">各节点中数据变化</h3><h4 id="scanRegistration-2">scanRegistration</h4><p><img src="/2022/10/03/20221003/scanRegistration%E6%95%B0%E6%8D%AE%E5%8F%98%E5%8C%96.jpg" alt="scanRegistration数据变化"></p><h4 id="laserOdometry-2">laserOdometry</h4><p><img src="/2022/10/03/20221003/laserOdometry%E6%95%B0%E6%8D%AE%E5%8F%98%E5%8C%96.jpg" alt="laserOdometry数据变化"></p><h4 id="laserMapping-2">laserMapping</h4><p><img src="/2022/10/03/20221003/laserMapping%E6%95%B0%E6%8D%AE%E5%8F%98%E5%8C%96.jpg" alt="laserMapping数据变化"></p><h2 id="前后端优化区别">前后端优化区别</h2><ol><li><p>里程计使用极大边缘点与次极大边缘点匹配；后端优化使用次极大边缘点与次极大边缘点匹配；平面点同理</p><p>【注】里程计用于待匹配的极大边缘点就是后端优化用于匹配的边缘点</p></li><li><p>里程计是相邻两帧之间匹配；后端优化是当前帧与子图匹配</p></li><li><p>里程计是得到的是连续的位姿变换；后端优化是离散的</p></li><li><p>里程计是高频率低精度；后端优化是低频率高精度</p></li><li><p>边缘点：里程计是当前点与两个最近点组成的线构建残差；后端优化是当前点与五个最近点特征向量虚构的两个点构建残差</p><p>平面点：里程计是当前点与三个最近点组成的面构建残差；后端优化是当前点与五个最近点所拟合平面的法向量构建残差</p></li><li><p>里程计匹配时用的是各自的雷达坐标系；后端优化匹配时使用的是世界坐标系</p></li><li><p>里程计维护的是每一帧到世界坐标系的位姿；后端优化还要维护与里程计估计值的转换</p></li></ol><h2 id="Mapping算法理解">Mapping算法理解</h2><p>2022/10/11更新</p><ol><li><p>Mapping 算法的目的还是计算 <code>q_w_curr</code> 和 <code>t_w_curr</code> ，即当前帧到世界坐标系下的位姿变换</p></li><li><p>过程为当前帧的点和历史帧构成的子图匹配</p></li><li><p>实现方式是维护栅格地图，也就是说，地图维护的目的是通过栅格索引找到子图</p></li><li><p>世界坐标系与栅格地图的关系如下：</p><p><img src="/2022/10/03/20221003/%E6%A0%85%E6%A0%BC%E5%9C%B0%E5%9B%BE%E4%B8%8E%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E5%85%B3%E7%B3%BB.png" alt="栅格地图与世界坐标系关系"></p><p>即<code>世界坐标系</code>和<code>点的坐标</code>一直保持<strong>不变</strong>，<code>栅格地图框架</code>在<strong>移动</strong>，表现出来就是<strong>点对应的栅格索引在改变</strong>；二者之间的转换通过程序中记录世界坐标系原点所在栅格的 <code>laserCloudCenWidth</code> 、 <code>laserCloudCenHeight</code> 、<code>laserCloudCenDepth</code> 三个变量实现</p></li><li><p>实际地图维护过程(以 I 方向上  &gt; 18 为例)：</p><p><img src="/2022/10/03/20221003/%E4%B8%96%E7%95%8C%E5%9D%90%E6%A0%87%E7%B3%BB%E4%B8%8B%E5%9C%B0%E5%9B%BE%E7%A7%BB%E5%8A%A8.png" alt="世界坐标系下地图移动"></p></li></ol>]]></content>
      
      
      <categories>
          
          <category> SLAM代码阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> A-LOAM </tag>
            
            <tag> 算法分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>A-LOAM算法分析</title>
      <link href="/2022/09/26/20220926/"/>
      <url>/2022/09/26/20220926/</url>
      
        <content type="html"><![CDATA[<h1>A-LOAM算法分析</h1><h2 id="思路分析">思路分析</h2><p><img src="/2022/09/26/20220926/A-LOAM%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90.png" alt="A-LOAM思路分析"></p><p>因此，算法全程只在做一件事：求位姿变换</p><p>【注】位姿变换指的是每一帧点云在世界坐标系下的位姿，也可以理解为<code>点云所处的雷达坐标系</code>到<code>世界坐标系</code>下的变换</p><p><img src="/2022/09/26/20220926/%E7%82%B9%E4%BA%91%E9%85%8D%E5%87%86.png" alt="点云配准"></p><p>通过点云配准的方式求解位姿变换，点云配准一般分为粗配准和精配准，为了保证算法的实时性，采用二者结合的方式获得满足实时性要求的高精度地图</p><p>粗配准：高频率，低精度，计算量小，耗时短</p><p>精配准：低频率，高精度，计算量大，耗时长</p><h2 id="流程分析">流程分析</h2><p><img src="/2022/09/26/20220926/%E6%B5%81%E7%A8%8B%E5%88%86%E6%9E%90.png" alt="流程分析"></p><p>A-LOAM算法流程分为三部分：<code>数据预处理</code> ，<code>前端里程计</code> ，<code>后端优化与建图</code></p><p><strong>数据预处理</strong>：去除无效点，根据曲率提取特征点</p><p><strong>前端里程计</strong>：相邻两帧进行点云匹配，求得每相邻两帧的位姿变换</p><p><strong>后端优化与建图</strong>：当前帧与子图匹配，根据设定频率每隔几帧求得一帧的位姿变换，同时实现建图</p><h2 id="代码分析">代码分析</h2><h3 id="scanRegistration">scanRegistration</h3><p>主要功能：提取特征点，为后续节点的匹配做准备</p><p>提取特征点有以下要求：</p><ol><li>点云是处理过的有效的</li><li>特征点是根据扫描线划分且均匀分布的</li><li>特征点是根据曲率划分的</li><li>为了方便后续的匹配，计算每个点运动补偿的时间</li></ol><p>因此为完成提取特征点的功能，要有以下流程：<code>数据预处理</code>，<code>计算扫描线</code>，<code>计算运动补偿时间</code>，<code>计算曲率</code>，<code>提取特征点</code></p><h4 id="数据预处理">数据预处理</h4><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 去除 NAN点</span></span><br><span class="line">pcl::<span class="built_in">removeNaNFromPointCloud</span>(laserCloudIn, laserCloudIn, indices);</span><br><span class="line"><span class="comment">// 去除与雷达距离过近的点</span></span><br><span class="line"><span class="built_in">removeClosedPointCloud</span>(laserCloudIn, laserCloudIn, MINIMUM_RANGE);</span><br></pre></td></tr></table></figure><h4 id="计算扫描线与运动补偿时间">计算扫描线与运动补偿时间</h4><p><img src="/2022/09/26/20220926/%E4%BF%AF%E4%BB%B0%E8%A7%92%E4%B8%8E%E6%B0%B4%E5%B9%B3%E8%A7%92.png" alt="俯仰角与水平角"></p><p><strong>俯仰角</strong>用于计算每个点所属扫描线，存储在每个点 <code>intensity</code> 属性的<strong>整数</strong>部分</p><p><strong>水平角</strong>用于计算每个点相对起始点的运动时间，存储在每个点 <code>intensity</code> 属性的<strong>小数</strong>部分</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算起始点和结束点的水平角，方便后续计算运动补偿所需的时间间隔</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> cloudSize = laserCloudIn.points.<span class="built_in">size</span>();  <span class="comment">// 数据处理后点云中点的数量</span></span><br><span class="line">    <span class="comment">// 计算起始点和结束点的角度；结束点 + 2π 是为了保证起始到结束相差2π，更符合实际；</span></span><br><span class="line">    <span class="comment">// 负号是按激光雷达旋转方向取反，从顺时针变为逆时针</span></span><br><span class="line">    <span class="type">float</span> startOri = -<span class="built_in">atan2</span>(laserCloudIn.points[<span class="number">0</span>].y, laserCloudIn.points[<span class="number">0</span>].x);</span><br><span class="line">    <span class="type">float</span> endOri = -<span class="built_in">atan2</span>(laserCloudIn.points[cloudSize - <span class="number">1</span>].y, laserCloudIn.points[cloudSize - <span class="number">1</span>].x) + <span class="number">2</span> * M_PI;</span><br><span class="line">    <span class="comment">// 角度修正，以保持结束点的朝向和起始点的方向差始终在 2pi 附近</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 子点云,大小为扫描线数量，每个数组元素为一条扫描线上的点云</span></span><br><span class="line">std::vector&lt;pcl::PointCloud&lt;PointType&gt;&gt; <span class="built_in">laserCloudScans</span>(N_SCANS);  </span><br><span class="line"></span><br><span class="line"><span class="comment">// 遍历所有点，计算所属扫描线，及相对起始点的运动时间</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cloudSize; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当前点的俯仰角</span></span><br><span class="line">    <span class="type">float</span> angle = <span class="built_in">atan</span>(point.z / <span class="built_in">sqrt</span>(point.x * point.x + point.y * point.y)) * <span class="number">180</span> / M_PI;  </span><br><span class="line">    <span class="comment">// 计算当前点所属的扫描线</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">    <span class="type">float</span> ori = -<span class="built_in">atan2</span>(point.y, point.x);  <span class="comment">// 当前点的水平角</span></span><br><span class="line">    <span class="comment">// 角度修正</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 计算该时刻相对起始时刻的时间间隔</span></span><br><span class="line">    <span class="type">float</span> relTime = (ori - startOri) / (endOri - startOri);</span><br><span class="line">    <span class="comment">// 小技巧：用 intensity的整数部分和小数部分来存储该点所属的扫描线以及相对时间</span></span><br><span class="line">    point.intensity = scanID + scanPeriod * relTime;</span><br><span class="line">    <span class="comment">// 根据scan的idx送入各自数组(子点云laserCloudScans)</span></span><br><span class="line">    laserCloudScans[scanID].<span class="built_in">push_back</span>(point);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="计算曲率">计算曲率</h4><p>曲率计算方式：当前点与前后各五个点的距离平方和</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算每个点的曲率，曲率表示方法为当前点和其周围 10 个点(左右各 5 个)的距离平方和</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">5</span>; i &lt; cloudSize - <span class="number">5</span>; i++)</span><br><span class="line">&#123; </span><br><span class="line">    <span class="type">float</span> diffX = ......;</span><br><span class="line">    <span class="type">float</span> diffY = ......;</span><br><span class="line">    <span class="type">float</span> diffZ = ......;</span><br><span class="line"></span><br><span class="line">    cloudCurvature[i] = diffX * diffX + diffY * diffY + diffZ * diffZ;</span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="提取特征点">提取特征点</h4><p>根据曲率进行排序，提取特征点；曲率大的为边缘点，小的为平面点，以16线雷达为例，只从满足要求的扫描线上提取</p><p>一帧点云有 16 条扫描线，每一条扫描线分 6 个区域，每个区域提取要求：</p><ul><li>2 个极大边缘点</li><li>20 个次极大边缘点 (其中包括两个极大边缘点)</li><li>4个极小平面点</li><li>其余点均为次极小平面点</li></ul><p>【注】以上的边缘点和极小平面点都需要满足曲率满足阈值才取，而非必须取足够数量的点</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; N_SCANS; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 不考虑少于 7 个点的扫描线</span></span><br><span class="line">    <span class="keyword">if</span>( scanEndInd[i] - scanStartInd[i] &lt; <span class="number">6</span>)</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">    pcl::PointCloud&lt;PointType&gt;::<span class="function">Ptr <span class="title">surfPointsLessFlatScan</span><span class="params">(<span class="keyword">new</span> pcl::PointCloud&lt;PointType&gt;)</span></span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">6</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 每个区域的起始和末尾指针</span></span><br><span class="line">        <span class="type">int</span> sp = scanStartInd[i] + (scanEndInd[i] - scanStartInd[i]) * j / <span class="number">6</span>; </span><br><span class="line">        <span class="type">int</span> ep = scanStartInd[i] + (scanEndInd[i] - scanStartInd[i]) * (j + <span class="number">1</span>) / <span class="number">6</span> - <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 按照曲率对当前区域的点进行从小到大排序</span></span><br><span class="line">        std::<span class="built_in">sort</span> (cloudSortInd + sp, cloudSortInd + ep + <span class="number">1</span>, comp);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 挑选边缘点</span></span><br><span class="line">        <span class="type">int</span> largestPickedNum = <span class="number">0</span>;  <span class="comment">// 曲率较大点的数量</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = ep; k &gt;= sp; k--)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 获得当前点在点云中索引</span></span><br><span class="line">            <span class="type">int</span> ind = cloudSortInd[k]; </span><br><span class="line"></span><br><span class="line">            <span class="comment">// 确认当前点没被选择过且曲率大于阈值</span></span><br><span class="line">            <span class="keyword">if</span> (cloudNeighborPicked[ind] == <span class="number">0</span> &amp;&amp; cloudCurvature[ind] &gt; <span class="number">0.1</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                largestPickedNum++;</span><br><span class="line">                <span class="comment">// 取 2 个曲率最大的点 </span></span><br><span class="line">                <span class="keyword">if</span> (largestPickedNum &lt;= <span class="number">2</span>)</span><br><span class="line">                    <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">                    <span class="comment">// 取 20 个曲率较大的点</span></span><br><span class="line">                    <span class="keyword">else</span> <span class="keyword">if</span> (largestPickedNum &lt;= <span class="number">20</span>)</span><br><span class="line">                        <span class="comment">// ......</span></span><br><span class="line">                        <span class="keyword">else</span></span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">                cloudNeighborPicked[ind] = <span class="number">1</span>;  <span class="comment">// 当前点筛选标志改为 1</span></span><br><span class="line"></span><br><span class="line">                <span class="comment">// 为了保证特征点不过度集中，将选中的点周围5个点都置1,避免后续会选到</span></span><br><span class="line">                <span class="comment">// 查看相邻点距离是否差异过大，如果差异过大说明点云在此不连续，是特征边缘，就会是新的特征，因此就不修改改标志</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">1</span>; l &lt;= <span class="number">5</span>; l++)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">float</span> diffX = ......;</span><br><span class="line">                    <span class="type">float</span> diffY = ......;</span><br><span class="line">                    <span class="type">float</span> diffZ = ......;</span><br><span class="line">                    <span class="keyword">if</span> (diffX * diffX + diffY * diffY + diffZ * diffZ &gt; <span class="number">0.05</span>)</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="comment">// 修改标志</span></span><br><span class="line">                    cloudNeighborPicked[ind + l] = <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="comment">// 与上文同理，处理左侧五个相邻点</span></span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> l = <span class="number">-1</span>; l &gt;= <span class="number">-5</span>; l--)</span><br><span class="line">                    <span class="comment">// ......</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 挑选平面点，过程与边缘点同理</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = sp; k &lt;= ep; k++)</span><br><span class="line">            <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 最后对该点云中提取的所有surf_less_flat特征点进行降采样，因为点太多了</span></span><br><span class="line">            <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="laserOdometry">laserOdometry</h3><p>主要功能：通过前后两帧的点云配准求得两帧之间的位姿变换关系，进而得到当前帧在世界坐标系下的位姿</p><p>该节点以点云配准为主，因此所有过程都为求解位姿服务，过程如下：<code>取出待匹配点云</code>，<code>ICP迭代</code>， <code>Ceres求解</code>，<code>更新用于匹配的目标点云</code></p><p>第一帧的初始位置的坐标系就是世界坐标系，因此从第二帧开始不断求得当前帧和前一帧间的位姿变换，不断迭代，就能得到每一帧在世界坐标系下的位姿；同时因为处理的是连续帧，即第一帧与第二帧，第二帧与第三帧，… ，因此得到的位姿也是连续变化的</p><p>由于通过前后相邻两帧之间配准，因此速度较快，但误差较大，即<strong>高频率低精度</strong></p><p><strong>几个变量说明：</strong></p><ol><li><p><code>q_w_curr</code> 和 <code>t_w_curr</code> 是想要得到当前帧在世界坐标系下的位姿</p></li><li><p><code>para_q</code> 和 <code>para_t</code> 是点云匹配是位姿变换的优化变量</p></li><li><p><code>q_last_curr</code> 和 <code>t_last_curr</code> 是里程计部分优化得到的两帧间位姿变换的结果</p></li></ol><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 2 和 3 由于共用内存，因此是相同的，优化 2 就是优化 3</span></span><br><span class="line"><span class="function">Eigen::Map&lt;Eigen::Quaterniond&gt; <span class="title">q_last_curr</span><span class="params">(para_q)</span></span>;</span><br><span class="line"><span class="function">Eigen::Map&lt;Eigen::Vector3d&gt; <span class="title">t_last_curr</span><span class="params">(<span class="type">para_t</span>)</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 世界坐标系下的位姿是通过不断迭代求得的</span></span><br><span class="line">t_w_curr = t_w_curr + q_w_curr * t_last_curr;</span><br><span class="line">q_w_curr = q_w_curr * q_last_curr;</span><br></pre></td></tr></table></figure><h4 id="取出待匹配点云">取出待匹配点云</h4><p>保证从队列中取出的五个点云时间戳相同，即五个点云来自同一帧数据</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> (!cornerSharpBuf.<span class="built_in">empty</span>() &amp;&amp; !cornerLessSharpBuf.<span class="built_in">empty</span>() &amp;&amp;</span><br><span class="line">            !surfFlatBuf.<span class="built_in">empty</span>() &amp;&amp; !surfLessFlatBuf.<span class="built_in">empty</span>() &amp;&amp;</span><br><span class="line">            !fullPointsBuf.<span class="built_in">empty</span>())  <span class="comment">// 保证所有队列都不为空</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 保证将要取出的五个点云出自同一帧</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 获得五个点云的时间戳</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 保证时间戳相同，即保证五个点云出自同一帧</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 取出对应的五个点云</span></span><br><span class="line">    &#123;</span><br><span class="line">        mBuf.<span class="built_in">lock</span>();</span><br><span class="line">        (......).<span class="built_in">pop</span>();</span><br><span class="line">        mBuf.<span class="built_in">unlock</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="ICP-迭代">ICP 迭代</h4><p>ICP迭代就是点云配准的<strong>主过程</strong>，分别对边缘点和平面点进行匹配</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 两次ICP迭代</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">size_t</span> opti_counter = <span class="number">0</span>; opti_counter &lt; <span class="number">2</span>; ++opti_counter)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 设置ceres问题</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 找边缘特征的对应关系</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cornerPointsSharpNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 找 2 个满足要求的最近点，构建点到线的残差</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 找平面特征的对应关系</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; surfPointsFlatNum; ++i)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 找 3 个满足要求的最近点，构建点到面的残差</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Ceres求解</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="边缘点匹配">边缘点匹配</h5><p>使用的是改进后的ICP迭代，通过点到线的距离构建残差</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 边缘点匹配</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; cornerPointsSharpNum; ++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 将该特征点O_cur 转换至上一帧坐标系下，记为点O</span></span><br><span class="line">    <span class="built_in">TransformToStart</span>(&amp;(cornerPointsSharp-&gt;points[i]), &amp;pointSel);</span><br><span class="line">    <span class="comment">// 在上一帧边缘点(包括极大，次极大边缘点)的KDTree中搜索点O的最近邻点，记为点A</span></span><br><span class="line">    kdtreeCornerLast-&gt;<span class="built_in">nearestKSearch</span>(pointSel, <span class="number">1</span>, pointSearchInd, pointSearchSqDis);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> closestPointInd = <span class="number">-1</span>;  <span class="comment">// 最近点A的索引</span></span><br><span class="line">    minPointInd2 = <span class="number">-1</span>;         <span class="comment">// 最近点B的索引</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// 点O与点A的距离平方小于阈值才认为有效</span></span><br><span class="line">    <span class="keyword">if</span> (pointSearchSqDis[<span class="number">0</span>] &lt; DISTANCE_SQ_THRESHOLD)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 记录最近点A的信息</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="type">double</span> minPointSqDis2 = DISTANCE_SQ_THRESHOLD;  <span class="comment">// 最近点B的距离平方和</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 在相邻扫描线上找第二个最近点B(一个线在某一段中最多有一个边缘点；相邻有上下两条)</span></span><br><span class="line">        <span class="comment">// 沿扫描线增加的方向搜索</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = closestPointInd + <span class="number">1</span>; j &lt; (<span class="type">int</span>)laserCloudCornerLast-&gt;points.<span class="built_in">size</span>(); ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 同一条扫描线则continue</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">int</span>(laserCloudCornerLast-&gt;points[j].intensity) &lt;= closestPointScanID)</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 不在附近扫描线上则退出循环</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">int</span>(laserCloudCornerLast-&gt;points[j].intensity) &gt; (closestPointScanID + NEARBY_SCAN))</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 求距离</span></span><br><span class="line">            <span class="type">double</span> pointSqDis = ......(x*x+y*y+z*z)</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (pointSqDis &lt; minPointSqDis2)</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="comment">// 找到最近点B</span></span><br><span class="line">                minPointSqDis2 = pointSqDis;</span><br><span class="line">                minPointInd2 = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 同理，沿扫描线减小的方向搜索</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = closestPointInd - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)</span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (minPointInd2 &gt;= <span class="number">0</span>) <span class="comment">// 最近点A和B都有效，构建残差项</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 构建三个点O,A,B</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 运动补偿时间 s</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 用点O，A，B构造点到线距离的残差项</span></span><br><span class="line">        ceres::CostFunction *cost_function = LidarEdgeFactor::<span class="built_in">Create</span>(curr_point, last_point_a, last_point_b, s);</span><br><span class="line">        problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, para_q, <span class="type">para_t</span>);</span><br><span class="line">        corner_correspondence++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="平面点匹配">平面点匹配</h5><p>使用的是改进后的ICP迭代，通过点到面的距离构建残差</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 平面点匹配</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; surfPointsFlatNum; ++i)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 与边缘点同理，区别仅在于找A,B,C三个最近点</span></span><br><span class="line">    <span class="comment">// A,B在同一条扫描线，C在点A相邻扫描线</span></span><br><span class="line">    <span class="built_in">TransformToStart</span>(&amp;(surfPointsFlat-&gt;points[i]), &amp;pointSel);</span><br><span class="line">    kdtreeSurfLast-&gt;<span class="built_in">nearestKSearch</span>(pointSel, <span class="number">1</span>, pointSearchInd, pointSearchSqDis);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 最近点A,B,C的索引</span></span><br><span class="line">    <span class="type">int</span> closestPointInd = <span class="number">-1</span>, minPointInd2 = <span class="number">-1</span>, minPointInd3 = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">if</span> (pointSearchSqDis[<span class="number">0</span>] &lt; DISTANCE_SQ_THRESHOLD)</span><br><span class="line">    &#123;</span><br><span class="line">        closestPointInd = pointSearchInd[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 记录最近点A的信息</span></span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 扫描线ID增长方向遍历平面点</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = closestPointInd + <span class="number">1</span>; j &lt; (<span class="type">int</span>)laserCloudSurfLast-&gt;points.<span class="built_in">size</span>(); ++j)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 不在附近扫描线，终止循环</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">int</span>(laserCloudSurfLast-&gt;points[j].intensity) &gt; (closestPointScanID + NEARBY_SCAN))</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="type">double</span> pointSqDis = ......;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 同一扫描线找最近点B</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">int</span>(laserCloudSurfLast-&gt;points[j].intensity) &lt;= closestPointScanID &amp;&amp; pointSqDis &lt; minPointSqDis2)</span><br><span class="line">            &#123;</span><br><span class="line">                minPointSqDis2 = pointSqDis;</span><br><span class="line">                minPointInd2 = j;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">// 相邻扫描线找最近点C</span></span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (<span class="built_in">int</span>(laserCloudSurfLast-&gt;points[j].intensity) &gt; closestPointScanID &amp;&amp; pointSqDis &lt; minPointSqDis3)</span><br><span class="line">            &#123;</span><br><span class="line">                minPointSqDis3 = pointSqDis;</span><br><span class="line">                minPointInd3 = j;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 扫描线ID下降方向，与上文同理</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = closestPointInd - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j)</span><br><span class="line">        <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (minPointInd2 &gt;= <span class="number">0</span> &amp;&amp; minPointInd3 &gt;= <span class="number">0</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 构造点O,A,B,C</span></span><br><span class="line">            <span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line">            <span class="comment">// 构建残差</span></span><br><span class="line">            ceres::CostFunction *cost_function = LidarPlaneFactor::<span class="built_in">Create</span>(curr_point, last_point_a, last_point_b, last_point_c, s);</span><br><span class="line">            problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, para_q, <span class="type">para_t</span>);</span><br><span class="line">            plane_correspondence++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Ceres求解">Ceres求解</h4><p>Ceres通过初始化问题，构建鲁棒核函数，传入优化变量和残差项，设定求解方式和迭代次数进行求解</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 设置ceres问题</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 损失函数，就是鲁棒核函数，0.1代表残差大于0.1的点,则权重降低,小于0.1则认为正常,不做特殊的处理</span></span><br><span class="line">    ceres::LossFunction *loss_function = <span class="keyword">new</span> ceres::<span class="built_in">HuberLoss</span>(<span class="number">0.1</span>); </span><br><span class="line">    <span class="comment">// 本地参数，对于SLAM，常用四元数</span></span><br><span class="line">    ceres::LocalParameterization *q_parameterization =</span><br><span class="line">        <span class="keyword">new</span> ceres::<span class="built_in">EigenQuaternionParameterization</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// problem类就是代表具有双边约束的最小二乘问题</span></span><br><span class="line">    <span class="comment">// 为了创建一个最小二乘问题,需要使用</span></span><br><span class="line">    <span class="comment">// Problem::AddResidalBlock() 添加残差模块</span></span><br><span class="line">    <span class="comment">// Problem::AddParameterBlock() 添加参数模块</span></span><br><span class="line">    ceres::Problem::Options problem_options;                   <span class="comment">// 先定义</span></span><br><span class="line">    <span class="function">ceres::Problem <span class="title">problem</span><span class="params">(problem_options)</span></span>;                   <span class="comment">// 再初始化</span></span><br><span class="line">    problem.<span class="built_in">AddParameterBlock</span>(para_q, <span class="number">4</span>, q_parameterization);  <span class="comment">// 添加四元数的参数块</span></span><br><span class="line">    problem.<span class="built_in">AddParameterBlock</span>(<span class="type">para_t</span>, <span class="number">3</span>);                      <span class="comment">// 添加平移的参数块</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入残差项</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 边缘点：用点O，A，B构造点到线距离的残差项(只列出一次过程，实际是ICP迭代过程循环传入)</span></span><br><span class="line">    ceres::CostFunction *cost_function = LidarEdgeFactor::<span class="built_in">Create</span>(curr_point, last_point_a, last_point_b, s);</span><br><span class="line">    problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, para_q, <span class="type">para_t</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 平面点：用点O，A，B，C构造点到面距离的残差项(同理，只列出一次过程)</span></span><br><span class="line">    ceres::CostFunction *cost_function = LidarPlaneFactor::<span class="built_in">Create</span>(curr_point, last_point_a, last_point_b, last_point_c, s);</span><br><span class="line">    problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, para_q, <span class="type">para_t</span>);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ceres求解</span></span><br><span class="line">&#123;</span><br><span class="line">    ceres::Solver::Options options;</span><br><span class="line">    options.linear_solver_type = ceres::DENSE_QR;  <span class="comment">// 配置增量方程的解法</span></span><br><span class="line">    options.max_num_iterations = <span class="number">4</span>;  <span class="comment">// 最大迭代次数</span></span><br><span class="line">    options.minimizer_progress_to_stdout = <span class="literal">false</span>;  <span class="comment">// 优化过程是否输出到终端</span></span><br><span class="line">    ceres::Solver::Summary summary;  <span class="comment">// 优化信息</span></span><br><span class="line">    ceres::<span class="built_in">Solve</span>(options, &amp;problem, &amp;summary);  <span class="comment">// 求解</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="更新用于匹配的目标点云">更新用于匹配的目标点云</h4><p>该步骤的主要目的是更新KDTree，用于下一帧找最近点</p><p>对于第一帧来说，不需要进行匹配，直接将边缘点点云和平面点点云放入目标点云即可，构建KDTree，用于下一帧匹配；</p><p>对于第一帧之后的帧，每次处理完后，将当前帧边缘点和平面点点云放入目标点云，构建KDTree，用于下一帧匹配；</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 更新相应数据，为下一次匹配做准备</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 用 cornerPointsLessSharp 更新 laserCloudCornerLast</span></span><br><span class="line">    pcl::PointCloud&lt;PointType&gt;::Ptr laserCloudTemp = cornerPointsLessSharp;</span><br><span class="line">    cornerPointsLessSharp = laserCloudCornerLast;</span><br><span class="line">    laserCloudCornerLast = laserCloudTemp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 用 surfPointsLessFlat 更新 laserCloudSurfLast</span></span><br><span class="line">    laserCloudTemp = surfPointsLessFlat;</span><br><span class="line">    surfPointsLessFlat = laserCloudSurfLast;</span><br><span class="line">    laserCloudSurfLast = laserCloudTemp;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 更新相应的KDTree，为下一次点云特征匹配提供target</span></span><br><span class="line">    laserCloudCornerLastNum = laserCloudCornerLast-&gt;points.<span class="built_in">size</span>();</span><br><span class="line">    laserCloudSurfLastNum = laserCloudSurfLast-&gt;points.<span class="built_in">size</span>();</span><br><span class="line">    kdtreeCornerLast-&gt;<span class="built_in">setInputCloud</span>(laserCloudCornerLast);</span><br><span class="line">    kdtreeSurfLast-&gt;<span class="built_in">setInputCloud</span>(laserCloudSurfLast);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="laserMapping">laserMapping</h3><p>主要功能：通过当前帧与子图之间进行点云配准求得当前帧在世界坐标系下的位姿</p><p>该节点主要进行点云精配准，即前文所说的当前帧和子图之间配准，过程如下：<code>Buffer预处理</code> ，<code>地图预处理</code>，<code>提取局部地图</code>，<code>ICP迭代</code>，<code>Ceres求解</code>，<code>更新位姿和地图</code></p><p>与前端里程计不同，laserMapping节点接收到的点云数据不是连续的，而是由前端里程计对频率进行控制，由参数<code>skipFrameNum</code> 的值进行控制；例如设置 <code>skipFrameNum = 2</code> ，则前端里程计每处理两帧，才将最新的一帧发出去，同时由于后端优化时间较长，会将来不及处理的帧直接丢弃，因此后端优化得到的位姿是离散的</p><p>由于是当前帧和子图进行配准，因此速度较慢，误差相比里程计更小，即<strong>低频率高精度</strong></p><p><strong>变量说明：</strong></p><ol><li><code>q_w_curr</code> 和 <code>t_w_curr</code> 是 Mapping 线程估计的当前帧在世界坐标系下的位姿</li><li><code>q_wodom_curr</code> 和 <code>t_wodom_curr</code> 是里程计估计的当前帧在世界坐标系下的位姿</li><li><code>q_wmap_wodom</code> 和 <code>t_wmap_wodom</code> 是世界坐标系下里程计估计的位姿与 Mapping 估计的位姿间的增量</li></ol><p>后端优化过程比较耗时，为了保证算法实时性，有两个<strong>特殊处理</strong></p><ol><li>Buffer预处理时，以最旧一帧边缘点为标准，取出后将队列清空，保证每次处理的都是最新的数据</li><li>接收里程计估计的位姿时，将上一次得到的增量与其相乘，作为Mapping估计的位姿直接发布，后续再更新</li></ol><h4 id="Buffer预处理">Buffer预处理</h4><p>与上一节里程计相同，对取出点云的时间戳进行判定，保证取出的点云属于同一帧</p><p>同时按照上文说的特殊处理，将边缘点队列清空</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Buffer预处理</span></span><br><span class="line"><span class="keyword">while</span>(<span class="comment">// 所有队列不为空)</span></span><br><span class="line">&#123;</span><br><span class="line">mBuf.<span class="built_in">lock</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(<span class="comment">// 时间戳小于边缘点点云)</span></span><br><span class="line">    (......).pop;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(<span class="comment">// 时间戳不同)</span></span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 从队列中取出并存储 边缘点、平面点、所有点点云 以及 里程计估计的位姿</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 清空边缘点队列</span></span><br><span class="line">    <span class="keyword">while</span>(!cornerLastBuf.<span class="built_in">empty</span>())</span><br><span class="line">    cornerLastBuf.<span class="built_in">pop</span>();</span><br><span class="line">    </span><br><span class="line">    mBuf.<span class="built_in">unlock</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="地图预处理">地图预处理</h4><p>全局地图划分栅格，分辨率为50，即每个格的边对应现实世界50m，共划分为21×21×11的三维栅格，子图为5×5×3的局部栅格地图，如下图左侧所示，后文采用简化版(图中右侧)进行分析</p><p><img src="/2022/09/26/20220926/%E6%A0%85%E6%A0%BC%E5%9C%B0%E5%9B%BE.png" alt="栅格地图"></p><p>栅格地图需要进行维护，即每次找到当前帧在世界坐标系下的位姿所处的栅格，周围留出足够的空间用于存放周围点云，如果所处栅格在栅格地图边缘，则对地图进行移动以满足条件；具体为保证位姿所处的栅格范围在I,J,K方向上分别满足3-18，3-18，3-8，若不满足则移动整体地图，直到满足条件(下图以在I方向上 &gt; 18 为例进行地图维护)</p><p><img src="/2022/09/26/20220926/%E5%9C%B0%E5%9B%BE%E7%BB%B4%E6%8A%A4.png" alt="地图维护"></p><p>在代码上表现为 6 个 while 循环</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 计算当前位姿在全局三维栅格中存放的位置（索引），栅格分辨率为 50 </span></span><br><span class="line"><span class="comment">// + 25.0 起四舍五入的作用，([0, 25) 取 0, [25, 50&#125; 进一)</span></span><br><span class="line"><span class="type">int</span> centerCubeI = <span class="built_in">int</span>((t_w_curr.<span class="built_in">x</span>() + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenWidth;</span><br><span class="line"><span class="type">int</span> centerCubeJ = <span class="built_in">int</span>((t_w_curr.<span class="built_in">y</span>() + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenHeight;</span><br><span class="line"><span class="type">int</span> centerCubeK = <span class="built_in">int</span>((t_w_curr.<span class="built_in">z</span>() + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenDepth;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对负数的情况做出调整，保证 (-1, -1 , -1) 不会和 (0, 0, 0) 存在同一位置</span></span><br><span class="line"><span class="keyword">if</span> (t_w_curr.<span class="built_in">x</span>() + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    centerCubeI--;</span><br><span class="line"><span class="keyword">if</span> (t_w_curr.<span class="built_in">y</span>() + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    centerCubeJ--;</span><br><span class="line"><span class="keyword">if</span> (t_w_curr.<span class="built_in">z</span>() + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    centerCubeK--;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下面 6 个循环分别对6种不满足条件的情况进行地图维护</span></span><br><span class="line"><span class="comment">// 对宽度方向小于要求进行维护</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeI &lt; <span class="number">3</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 过程类似于数组元素的移动，只需要注意索引即可</span></span><br><span class="line">    <span class="comment">// ......</span></span><br><span class="line">    </span><br><span class="line">    centerCubeI++;</span><br><span class="line">    <span class="comment">// 在移动完点云后，需要将原点对应的栅格坐标也向宽度正方向移动一个单位，保证栅格坐标计算的正确性</span></span><br><span class="line">    laserCloudCenWidth++;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 对栅格宽度方向进行一样的操作</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeI &gt;= laserCloudWidth - <span class="number">3</span>) </span><br><span class="line"><span class="comment">// 对栅格高度方向进行一样的操作</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeJ &lt; <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 对栅格高度方向进行一样的操作</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeJ &gt;= laserCloudHeight - <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 对栅格深度方向进行一样的操作</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeK &lt; <span class="number">3</span>)</span><br><span class="line"><span class="comment">// 对栅格深度方向进行一样的操作</span></span><br><span class="line"><span class="keyword">while</span> (centerCubeK &gt;= laserCloudDepth - <span class="number">3</span>)</span><br></pre></td></tr></table></figure><h4 id="提取局部地图">提取局部地图</h4><p>局部地图，即上图中的绿色部分，提取出来并构建 KDTree ，用于后续与当前帧的匹配</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 获取当前位置周围的点云作为匹配对象</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = centerCubeI - <span class="number">2</span>; i &lt;= centerCubeI + <span class="number">2</span>; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> j = centerCubeJ - <span class="number">2</span>; j &lt;= centerCubeJ + <span class="number">2</span>; j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> k = centerCubeK - <span class="number">1</span>; k &lt;= centerCubeK + <span class="number">1</span>; k++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= <span class="number">0</span> &amp;&amp; i &lt; laserCloudWidth &amp;&amp;</span><br><span class="line">                j &gt;= <span class="number">0</span> &amp;&amp; j &lt; laserCloudHeight &amp;&amp;</span><br><span class="line">                k &gt;= <span class="number">0</span> &amp;&amp; k &lt; laserCloudDepth)</span><br><span class="line">            &#123; </span><br><span class="line">                laserCloudValidInd[laserCloudValidNum] = i + laserCloudWidth * j + laserCloudWidth * laserCloudHeight * k;</span><br><span class="line">                laserCloudValidNum++;</span><br><span class="line">                laserCloudSurroundInd[laserCloudSurroundNum] = i + laserCloudWidth * j + laserCloudWidth * laserCloudHeight * k;</span><br><span class="line">                laserCloudSurroundNum++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 提取局部地图点云（当前载体附近的点云）</span></span><br><span class="line">laserCloudCornerFromMap-&gt;<span class="built_in">clear</span>();</span><br><span class="line">laserCloudSurfFromMap-&gt;<span class="built_in">clear</span>();</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudValidNum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    *laserCloudCornerFromMap += *laserCloudCornerArray[laserCloudValidInd[i]];</span><br><span class="line">    *laserCloudSurfFromMap += *laserCloudSurfArray[laserCloudValidInd[i]];</span><br><span class="line">&#125;</span><br><span class="line"><span class="type">int</span> laserCloudCornerFromMapNum = laserCloudCornerFromMap-&gt;points.<span class="built_in">size</span>();</span><br><span class="line"><span class="type">int</span> laserCloudSurfFromMapNum = laserCloudSurfFromMap-&gt;points.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对待处理的边缘点点云进行降采样处理</span></span><br><span class="line">pcl::PointCloud&lt;PointType&gt;::<span class="function">Ptr <span class="title">laserCloudCornerStack</span><span class="params">(<span class="keyword">new</span> pcl::PointCloud&lt;PointType&gt;())</span></span>;</span><br><span class="line">downSizeFilterCorner.<span class="built_in">setInputCloud</span>(laserCloudCornerLast);</span><br><span class="line">downSizeFilterCorner.<span class="built_in">filter</span>(*laserCloudCornerStack);</span><br><span class="line"><span class="type">int</span> laserCloudCornerStackNum = laserCloudCornerStack-&gt;points.<span class="built_in">size</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">// 对待处理的平面点云进行降采样处理</span></span><br><span class="line">pcl::PointCloud&lt;PointType&gt;::<span class="function">Ptr <span class="title">laserCloudSurfStack</span><span class="params">(<span class="keyword">new</span> pcl::PointCloud&lt;PointType&gt;())</span></span>;</span><br><span class="line">downSizeFilterSurf.<span class="built_in">setInputCloud</span>(laserCloudSurfLast);</span><br><span class="line">downSizeFilterSurf.<span class="built_in">filter</span>(*laserCloudSurfStack);</span><br><span class="line"><span class="type">int</span> laserCloudSurfStackNum = laserCloudSurfStack-&gt;points.<span class="built_in">size</span>();</span><br></pre></td></tr></table></figure><h4 id="ICP迭代">ICP迭代</h4><p>与前端里程计基本一致，区别在于：</p><ol><li>匹配使用的点云不同(里程计是极大和次极大匹配；Mapping 是次极大和次极大匹配)</li><li>构建残差的方式不同(里程计是两点建线，三点建面；Mapping 是特征向量建线，法向量建面)</li><li>坐标系不同(里程计匹配的点坐标系与待匹配的点在各自坐标系下；Mapping 则均为世界坐标系)</li></ol><h5 id="边缘点匹配-2">边缘点匹配</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 边缘点匹配，构建残差</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudCornerStackNum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 获取原始点并将其坐标转换至全局坐标系，在角点 KD 树搜索最近的 5 个点</span></span><br><span class="line">    pointOri = laserCloudCornerStack-&gt;points[i];</span><br><span class="line">    <span class="comment">// 需要注意的是submap中的点云都是world坐标系，而当前帧的点云都是Lidar坐标系，所以</span></span><br><span class="line">    <span class="comment">// 在搜寻最近邻点时，先用预测的Mapping位姿w_curr，将Lidar坐标系下的特征点变换到world坐标系下</span></span><br><span class="line">    <span class="built_in">pointAssociateToMap</span>(&amp;pointOri, &amp;pointSel);</span><br><span class="line">    kdtreeCornerFromMap-&gt;<span class="built_in">nearestKSearch</span>(pointSel, <span class="number">5</span>, pointSearchInd, pointSearchSqDis); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当搜索到的 5 个点都在当前选择点的 1m 范围内，才进行以下操作</span></span><br><span class="line">    <span class="keyword">if</span> (pointSearchSqDis[<span class="number">4</span>] &lt; <span class="number">1.0</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="comment">// 获取这 5 个点的位置并计算其平均值作为线段中心</span></span><br><span class="line">        std::vector&lt;Eigen::Vector3d&gt; nearCorners;</span><br><span class="line">        <span class="function">Eigen::Vector3d <span class="title">center</span><span class="params">(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="function">Eigen::Vector3d <span class="title">tmp</span><span class="params">(laserCloudCornerFromMap-&gt;points[pointSearchInd[j]].x,</span></span></span><br><span class="line"><span class="params"><span class="function">                                laserCloudCornerFromMap-&gt;points[pointSearchInd[j]].y,</span></span></span><br><span class="line"><span class="params"><span class="function">                                laserCloudCornerFromMap-&gt;points[pointSearchInd[j]].z)</span></span>;</span><br><span class="line">            center = center + tmp;</span><br><span class="line">            nearCorners.<span class="built_in">push_back</span>(tmp);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 计算这个5个最近邻点的中心</span></span><br><span class="line">        center = center / <span class="number">5.0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 根据距离设置这 5 个点的协方差矩阵 cov = sum(mean * mean^T)</span></span><br><span class="line">        Eigen::Matrix3d covMat = Eigen::Matrix3d::<span class="built_in">Zero</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            Eigen::Matrix&lt;<span class="type">double</span>, <span class="number">3</span>, <span class="number">1</span>&gt; tmpZeroMean = nearCorners[j] - center;</span><br><span class="line">            covMat = covMat + tmpZeroMean * tmpZeroMean.<span class="built_in">transpose</span>();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 计算协方差矩阵的特征值和特征向量，用于判断这5个点是不是呈线状分布，此为PCA的原理</span></span><br><span class="line">        <span class="function">Eigen::SelfAdjointEigenSolver&lt;Eigen::Matrix3d&gt; <span class="title">saes</span><span class="params">(covMat)</span></span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 如果是这 5 个点来至同一个线特征(5个点呈线状分布)，那么最大的特征值会比另外两个都大很多，</span></span><br><span class="line">        <span class="comment">// 并且其相应的特征向量表明该直线的方向，这里用 3 倍大小作为衡量标准</span></span><br><span class="line">        Eigen::Vector3d unit_direction = saes.<span class="built_in">eigenvectors</span>().<span class="built_in">col</span>(<span class="number">2</span>);</span><br><span class="line">        <span class="function">Eigen::Vector3d <span class="title">curr_point</span><span class="params">(pointOri.x, pointOri.y, pointOri.z)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (saes.<span class="built_in">eigenvalues</span>()[<span class="number">2</span>] &gt; <span class="number">3</span> * saes.<span class="built_in">eigenvalues</span>()[<span class="number">1</span>])</span><br><span class="line">        &#123; </span><br><span class="line">            <span class="comment">// 从中心点沿着方向向量向两端移动0.1m，构造线上的两个点</span></span><br><span class="line">            Eigen::Vector3d point_on_line = center;</span><br><span class="line">            Eigen::Vector3d point_a, point_b;</span><br><span class="line">            point_a = <span class="number">0.1</span> * unit_direction + point_on_line;</span><br><span class="line">            point_b = <span class="number">-0.1</span> * unit_direction + point_on_line;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 将两个点以及当前角点（注意是在点云中的，坐标是在载体坐标系下表示）传入 ceres 中构建残差</span></span><br><span class="line">            ceres::CostFunction *cost_function = LidarEdgeFactor::<span class="built_in">Create</span>(curr_point, point_a, point_b, <span class="number">1.0</span>);</span><br><span class="line">            problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, parameters, parameters + <span class="number">4</span>);</span><br><span class="line">            corner_num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="平面点匹配-2">平面点匹配</h5><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 平面点匹配，构建残差</span></span><br><span class="line"><span class="type">int</span> surf_num = <span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudSurfStackNum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 获取原始点并将其坐标转换至全局坐标系，在平面点的 KD 树搜索最近的 5 个点</span></span><br><span class="line">    pointOri = laserCloudSurfStack-&gt;points[i];</span><br><span class="line">    <span class="built_in">pointAssociateToMap</span>(&amp;pointOri, &amp;pointSel);</span><br><span class="line">    kdtreeSurfFromMap-&gt;<span class="built_in">nearestKSearch</span>(pointSel, <span class="number">5</span>, pointSearchInd, pointSearchSqDis);</span><br><span class="line"></span><br><span class="line">    Eigen::Matrix&lt;<span class="type">double</span>, <span class="number">5</span>, <span class="number">3</span>&gt; matA0;</span><br><span class="line">    Eigen::Matrix&lt;<span class="type">double</span>, <span class="number">5</span>, <span class="number">1</span>&gt; matB0 = <span class="number">-1</span> * Eigen::Matrix&lt;<span class="type">double</span>, <span class="number">5</span>, <span class="number">1</span>&gt;::<span class="built_in">Ones</span>();</span><br><span class="line">    <span class="comment">// 当搜索到的 5 个点都在当前选择点的 1m 范围内，才进行以下操作</span></span><br><span class="line">    <span class="keyword">if</span> (pointSearchSqDis[<span class="number">4</span>] &lt; <span class="number">1.0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// 将 5 个点按列插入 5x3 矩阵中</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">matA0</span>(j, <span class="number">0</span>) = laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].x;</span><br><span class="line">            <span class="built_in">matA0</span>(j, <span class="number">1</span>) = laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].y;</span><br><span class="line">            <span class="built_in">matA0</span>(j, <span class="number">2</span>) = laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].z;</span><br><span class="line">            <span class="comment">//printf(&quot; pts %f %f %f &quot;, matA0(j, 0), matA0(j, 1), matA0(j, 2));</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// 计算平面法向量，平面方程为 Ax + By + Cz = -1，代入 5 个点，利用最小二乘法解出参数即可得到法向量</span></span><br><span class="line">        Eigen::Vector3d norm = matA0.<span class="built_in">colPivHouseholderQr</span>().<span class="built_in">solve</span>(matB0);</span><br><span class="line">        <span class="comment">// Ax + By + Cz + 1 = 0，全部除以法向量的模长，方程依旧成立，而且使得法向量归一化了</span></span><br><span class="line">        <span class="type">double</span> negative_OA_dot_norm = <span class="number">1</span> / norm.<span class="built_in">norm</span>();</span><br><span class="line">        norm.<span class="built_in">normalize</span>();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 通过计算每个点到平面的距离来判断平面拟合的效果，距离公式为：d = |Ax + By + Cz + D|/sqrt(A^2+B^2+C^2)</span></span><br><span class="line">        <span class="comment">// 归一化后平面公式为：Ax + By + Cz + D = 0, D = 1/sqrt(A&#x27;^2+B&#x27;^2+C&#x27;^2)</span></span><br><span class="line">        <span class="comment">// 因此，计算公式为：d = Ax + By + Cz + negative_OA_dot_norm</span></span><br><span class="line">        <span class="type">bool</span> planeValid = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">5</span>; j++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// if OX * n &gt; 0.2, then plane is not fit well</span></span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">fabs</span>(<span class="built_in">norm</span>(<span class="number">0</span>) * laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].x +</span><br><span class="line">                     <span class="built_in">norm</span>(<span class="number">1</span>) * laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].y +</span><br><span class="line">                     <span class="built_in">norm</span>(<span class="number">2</span>) * laserCloudSurfFromMap-&gt;points[pointSearchInd[j]].z + negative_OA_dot_norm) &gt; <span class="number">0.2</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                planeValid = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">Eigen::Vector3d <span class="title">curr_point</span><span class="params">(pointOri.x, pointOri.y, pointOri.z)</span></span>;</span><br><span class="line">        <span class="keyword">if</span> (planeValid)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 将选择的点和法向量传入 ceres 中构建残差块</span></span><br><span class="line">            ceres::CostFunction *cost_function = LidarPlaneNormFactor::<span class="built_in">Create</span>(curr_point, norm, negative_OA_dot_norm);</span><br><span class="line">            problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, parameters, parameters + <span class="number">4</span>);</span><br><span class="line">            surf_num++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h4 id="Ceres求解-2">Ceres求解</h4><p>与里程计基本相同，都是通过设置Ceres问题，传入参数及优化变量进行求解，区别是残差项的构造不同</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 构建Ceres问题</span></span><br><span class="line">&#123;</span><br><span class="line">    ceres::LossFunction *loss_function = <span class="keyword">new</span> ceres::<span class="built_in">HuberLoss</span>(<span class="number">0.1</span>);  <span class="comment">// 损失函数</span></span><br><span class="line">    ceres::LocalParameterization *q_parameterization =</span><br><span class="line">        <span class="keyword">new</span> ceres::<span class="built_in">EigenQuaternionParameterization</span>();  <span class="comment">// 本地参数</span></span><br><span class="line">    ceres::Problem::Options problem_options;</span><br><span class="line"></span><br><span class="line">    <span class="function">ceres::Problem <span class="title">problem</span><span class="params">(problem_options)</span></span>;</span><br><span class="line">    problem.<span class="built_in">AddParameterBlock</span>(parameters, <span class="number">4</span>, q_parameterization);  <span class="comment">// 添加四元数参数快</span></span><br><span class="line">    problem.<span class="built_in">AddParameterBlock</span>(parameters + <span class="number">4</span>, <span class="number">3</span>);  <span class="comment">// 添加平移向量参数快</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入残差项(实际是在ICP迭代过程中循环传入)</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 边缘点：用点O及构造的A,B构建残差项(注意是在点云中的，坐标是在载体坐标系下表示)</span></span><br><span class="line">    ceres::CostFunction *cost_function = LidarEdgeFactor::<span class="built_in">Create</span>(curr_point, point_a, point_b, <span class="number">1.0</span>);</span><br><span class="line">    problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, parameters, parameters + <span class="number">4</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// 平面点：用点O及拟合平面的法向量构建残差项</span></span><br><span class="line">    ceres::CostFunction *cost_function = LidarPlaneNormFactor::<span class="built_in">Create</span>(curr_point, norm, negative_OA_dot_norm);</span><br><span class="line">    problem.<span class="built_in">AddResidualBlock</span>(cost_function, loss_function, parameters, parameters + <span class="number">4</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Ceres求解</span></span><br><span class="line">&#123;</span><br><span class="line">    TicToc t_solver;</span><br><span class="line">    ceres::Solver::Options options;</span><br><span class="line">    options.linear_solver_type = ceres::DENSE_QR;  <span class="comment">// 配置增量方程的解法</span></span><br><span class="line">    options.max_num_iterations = <span class="number">4</span>;  <span class="comment">// 最大迭代次数</span></span><br><span class="line">    options.minimizer_progress_to_stdout = <span class="literal">false</span>;  <span class="comment">// 优化过程是否输出到终端</span></span><br><span class="line">    options.check_gradients = <span class="literal">false</span>;  <span class="comment">// 检查优化是否失败，如果设置为true比较耗费性能，一般保持默认</span></span><br><span class="line">    options.gradient_check_relative_precision = <span class="number">1e-4</span>;  <span class="comment">// 在gradient checker中检查的精度</span></span><br><span class="line">    ceres::Solver::Summary summary;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="更新位姿和地图">更新位姿和地图</h4><p>更新前端里程计估计与Mapping之间估计的增量，同时将点云转换到世界坐标系下并插入到栅格中</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">transformUpdate</span>(); <span class="comment">// 利用优化后的全局位姿，更新相对于里程计位姿的转换（修正量）</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对当前新加入的边缘点点云中的所有点，进行坐标转换至世界坐标系下，找到其对应的点云栅格坐标</span></span><br><span class="line"><span class="comment">// 插入到该栅格中存放的点云中</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudCornerStackNum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">// 转换到世界坐标系下</span></span><br><span class="line">    <span class="built_in">pointAssociateToMap</span>(&amp;laserCloudCornerStack-&gt;points[i], &amp;pointSel);</span><br><span class="line"></span><br><span class="line">    <span class="type">int</span> cubeI = <span class="built_in">int</span>((pointSel.x + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenWidth;</span><br><span class="line">    <span class="type">int</span> cubeJ = <span class="built_in">int</span>((pointSel.y + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenHeight;</span><br><span class="line">    <span class="type">int</span> cubeK = <span class="built_in">int</span>((pointSel.z + <span class="number">25.0</span>) / <span class="number">50.0</span>) + laserCloudCenDepth;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (pointSel.x + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    cubeI--;</span><br><span class="line">    <span class="keyword">if</span> (pointSel.y + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    cubeJ--;</span><br><span class="line">    <span class="keyword">if</span> (pointSel.z + <span class="number">25.0</span> &lt; <span class="number">0</span>)</span><br><span class="line">    cubeK--;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (cubeI &gt;= <span class="number">0</span> &amp;&amp; cubeI &lt; laserCloudWidth &amp;&amp;</span><br><span class="line">    cubeJ &gt;= <span class="number">0</span> &amp;&amp; cubeJ &lt; laserCloudHeight &amp;&amp;</span><br><span class="line">    cubeK &gt;= <span class="number">0</span> &amp;&amp; cubeK &lt; laserCloudDepth)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> cubeInd = cubeI + laserCloudWidth * cubeJ + laserCloudWidth * laserCloudHeight * cubeK;</span><br><span class="line">        laserCloudCornerArray[cubeInd]-&gt;<span class="built_in">push_back</span>(pointSel);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 同理，对平面点云进行处理</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudSurfStackNum; i++)</span><br><span class="line"><span class="comment">// ......</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 对这次处理涉及到的点云进行降采样处理</span></span><br><span class="line"><span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; laserCloudValidNum; i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> ind = laserCloudValidInd[i];</span><br><span class="line"></span><br><span class="line">    pcl::PointCloud&lt;PointType&gt;::<span class="function">Ptr <span class="title">tmpCorner</span><span class="params">(<span class="keyword">new</span> pcl::PointCloud&lt;PointType&gt;())</span></span>;</span><br><span class="line">    downSizeFilterCorner.<span class="built_in">setInputCloud</span>(laserCloudCornerArray[ind]);</span><br><span class="line">    downSizeFilterCorner.<span class="built_in">filter</span>(*tmpCorner);</span><br><span class="line">    laserCloudCornerArray[ind] = tmpCorner;</span><br><span class="line"></span><br><span class="line">    pcl::PointCloud&lt;PointType&gt;::<span class="function">Ptr <span class="title">tmpSurf</span><span class="params">(<span class="keyword">new</span> pcl::PointCloud&lt;PointType&gt;())</span></span>;</span><br><span class="line">    downSizeFilterSurf.<span class="built_in">setInputCloud</span>(laserCloudSurfArray[ind]);</span><br><span class="line">    downSizeFilterSurf.<span class="built_in">filter</span>(*tmpSurf);</span><br><span class="line">    laserCloudSurfArray[ind] = tmpSurf;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> SLAM代码阅读 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> A-LOAM </tag>
            
            <tag> 算法分析 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>多传感器融合定位课程笔记(第一章)</title>
      <link href="/2022/09/09/20220909/"/>
      <url>/2022/09/09/20220909/</url>
      
        <content type="html"><![CDATA[<h1>Chapter13D激光里程计</h1><h2 id="激光雷达">激光雷达</h2><ol><li><p><strong>原理</strong>：传感器向周围发射脉冲，接收反射，根据二者时间间隔计算距离</p></li><li><p><strong>分类</strong>：</p><p>​1) 机械旋转雷达：视角范围大(±180°)，多激光束同时发射，绕固定轴旋转</p><p>​2) 固态雷达：视角范围小(如Livox Mid-40，±30°左右)，非重复扫描，扫描方式为梅花瓣状</p></li></ol><h2 id="前端里程计方案">前端里程计方案</h2><ul><li>基于直接匹配 ( ICP，NDT )</li><li>基于特征 ( LOAM系列 )</li><li>多传感器融合</li><li>…</li></ul><h2 id="基于直接匹配方式">基于直接匹配方式</h2><h3 id="ICP-迭代最近点">ICP(迭代最近点)</h3><ol><li><p><strong>原理</strong>：距离最近的点作匹配，最小化误差函数，求解位姿变换关系，不断迭代找最优解</p></li><li><p><strong>过程</strong>：</p><p>​1) 找欧式距离最小的点进行匹配</p><p>​2) 利用两点云重心计算旋转矩阵 <strong>R</strong> 和平移向量 <strong>t</strong></p><p>​3) 不断迭代(<strong>P-Q</strong>，<strong>P’-Q</strong>，<strong>P’'-Q</strong>)，求解位姿变换关系</p><p>​4) 平均距离小于设定阈值或达到迭代次数，结束算法</p></li><li><p><strong>缺点</strong>：要求初始的位姿必须很好</p></li><li><p><strong>改进</strong>：</p><p>​1) PL-ICP：使用点到其最近两点连线的距离作误差</p><p>​2) NICP：误差项考虑欧氏距离和对应点法向量的角度差</p><p>​3) IMLS-ICP：局部曲面建模，误差取点到曲面的距离</p><p>​4) …</p></li></ol><h3 id="NDT-正态分布变换">NDT(正态分布变换)</h3><ol><li><p><strong>原理</strong>：根据正态分布参数计算对应点落在对应网格中的概率之和，不断迭代使概率之和最大</p></li><li><p><strong>过程</strong>：</p><p>​1) 划分栅格</p><p>​2) 计算网格的概率分布模型</p><p>​3) 变换 <strong>Q</strong> 中的点云到 <strong>P</strong> 坐标系下</p><p>​4) 根据正态分布参数计算每个转换点落到对应栅格的概率</p><p>​5) 计算概率之和(NDT配准得分)</p><p>​6) 根据牛顿优化算法进行优化，求得概率最大时的参数</p><p>​7) 跳转到步骤 3) ，不断迭代(<strong>P-Q</strong>，<strong>P-Q</strong>’，<strong>P-Q</strong>’')，直到算法收敛</p></li><li><p><strong>优点</strong>：相比 ICP，计算量小，鲁棒性高</p></li></ol><h2 id="基于特征方式-LOAM系列">基于特征方式(LOAM系列)</h2><ul><li><p>LOAM</p></li><li><p>A-LOAM</p></li><li><p>FLOAM</p></li><li><p>LEGO-LOAM</p></li></ul><p><strong>[ 注 ]</strong> 以上算法源码阅读与分析见&quot;代码阅读&quot;模块</p><h2 id="数据集">数据集</h2><ol><li><p><strong>KITTI数据集</strong></p><p><img src="/2022/09/09/20220909/kitti%E6%95%B0%E6%8D%AE%E9%87%87%E9%9B%86%E8%BD%A6.png" alt="KITTI数据采集车"></p><p>使用数据集里的 RawData 数据，它包含 RTK、IMU、激光雷达、摄像头等传感器的数据，且时间戳已对齐</p></li><li><p><strong>使用</strong></p><p>​kitti2bag 将数据转化为 bag 文件</p></li></ol><h2 id="里程计工程框架实现">里程计工程框架实现</h2><p>参考知乎 “从零开始做自动驾驶定位三，四，五”</p><p><a href="https://zhuanlan.zhihu.com/p/113616755">从零开始做自动驾驶定位（文章汇总） - 知乎 (zhihu.com)</a></p><h2 id="里程计精度评价">里程计精度评价</h2><p>使用 evo 工具计算绝对位姿误差与相对位姿误差，对算法精度进行评价</p><p>使用方法可参考&quot;<a href="https://blog.csdn.net/qq_39779233/article/details/108299612">SLAM精度评定工具EVO使用方法详解_wongHome的博客-CSDN博客_evo slam</a>&quot;</p>]]></content>
      
      
      <categories>
          
          <category> 多传感器融合定位 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SLAM </tag>
            
            <tag> 多传感器融合 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
